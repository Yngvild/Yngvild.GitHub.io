<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>A Suggested solutions to exercises | Demographic methods in life history theory</title>
  <meta name="description" content="A Suggested solutions to exercises | Demographic methods in life history theory" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="A Suggested solutions to exercises | Demographic methods in life history theory" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Suggested solutions to exercises | Demographic methods in life history theory" />
  
  
  

<meta name="author" content="Yngvild Vindenes (yngvild.vindenes@ibv.uio.no)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="id_06-references.html"/>
<link rel="next" href="s07-Code-Collection.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="s01-Exponential.html"><a href="s01-Exponential.html"><i class="fa fa-check"></i><b>1</b> Exponential growth</a>
<ul>
<li class="chapter" data-level="1.1" data-path="s01-Exponential.html"><a href="s01-Exponential.html#learning-goals"><i class="fa fa-check"></i><b>1.1</b> Learning goals</a></li>
<li class="chapter" data-level="1.2" data-path="s01-Exponential.html"><a href="s01-Exponential.html#the-exponential-growth-model"><i class="fa fa-check"></i><b>1.2</b> The exponential growth model</a></li>
<li class="chapter" data-level="1.3" data-path="s01-Exponential.html"><a href="s01-Exponential.html#exponential-growth-in-structured-populations"><i class="fa fa-check"></i><b>1.3</b> Exponential growth in structured populations</a></li>
<li class="chapter" data-level="1.4" data-path="s01-Exponential.html"><a href="s01-Exponential.html#the-role-of-exponential-growth-in-ecology-and-evolution"><i class="fa fa-check"></i><b>1.4</b> The role of exponential growth in ecology and evolution</a></li>
<li class="chapter" data-level="1.5" data-path="s01-Exponential.html"><a href="s01-Exponential.html#exercises"><i class="fa fa-check"></i><b>1.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="s01-Exponential.html"><a href="s01-Exponential.html#exercise-1.1"><i class="fa fa-check"></i>Exercise 1.1</a></li>
<li class="chapter" data-level="" data-path="s01-Exponential.html"><a href="s01-Exponential.html#exercise-1.2"><i class="fa fa-check"></i>Exercise 1.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="s02-life-tables.html"><a href="s02-life-tables.html"><i class="fa fa-check"></i><b>2</b> Life tables</a>
<ul>
<li class="chapter" data-level="2.1" data-path="s02-life-tables.html"><a href="s02-life-tables.html#learning-goals-1"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="s02-life-tables.html"><a href="s02-life-tables.html#age-specific-survival-and-fecundity"><i class="fa fa-check"></i><b>2.2</b> Age-specific survival and fecundity</a></li>
<li class="chapter" data-level="2.3" data-path="s02-life-tables.html"><a href="s02-life-tables.html#life-history-strategies-and-trade-offs"><i class="fa fa-check"></i><b>2.3</b> Life history strategies and trade-offs</a></li>
<li class="chapter" data-level="2.4" data-path="s02-life-tables.html"><a href="s02-life-tables.html#a-basic-life-table"><i class="fa fa-check"></i><b>2.4</b> A basic life table</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="s02-life-tables.html"><a href="s02-life-tables.html#bird"><i class="fa fa-check"></i><b>2.4.1</b> Songbird example</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="s02-life-tables.html"><a href="s02-life-tables.html#dynamic-and-static-life-tables"><i class="fa fa-check"></i><b>2.5</b> Dynamic and static life tables</a></li>
<li class="chapter" data-level="2.6" data-path="s02-life-tables.html"><a href="s02-life-tables.html#life-table-calculations"><i class="fa fa-check"></i><b>2.6</b> Life table calculations</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="s02-life-tables.html"><a href="s02-life-tables.html#net-reproductive-rate"><i class="fa fa-check"></i><b>2.6.1</b> Net reproductive rate</a></li>
<li class="chapter" data-level="2.6.2" data-path="s02-life-tables.html"><a href="s02-life-tables.html#cohort-generation-time"><i class="fa fa-check"></i><b>2.6.2</b> Cohort generation time</a></li>
<li class="chapter" data-level="2.6.3" data-path="s02-life-tables.html"><a href="s02-life-tables.html#approximation-of-long-term-growth-rate"><i class="fa fa-check"></i><b>2.6.3</b> Approximation of long-term growth rate</a></li>
<li class="chapter" data-level="2.6.4" data-path="s02-life-tables.html"><a href="s02-life-tables.html#Euler"><i class="fa fa-check"></i><b>2.6.4</b> Euler-lotka equation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="s02-life-tables.html"><a href="s02-life-tables.html#fitness-measures-in-life-history-theory"><i class="fa fa-check"></i><b>2.7</b> Fitness measures in life history theory</a></li>
<li class="chapter" data-level="2.8" data-path="s02-life-tables.html"><a href="s02-life-tables.html#semelparity-and-iteroparity"><i class="fa fa-check"></i><b>2.8</b> Semelparity and iteroparity</a></li>
<li class="chapter" data-level="2.9" data-path="s02-life-tables.html"><a href="s02-life-tables.html#the-lack-clutch"><i class="fa fa-check"></i><b>2.9</b> The Lack clutch</a></li>
<li class="chapter" data-level="2.10" data-path="s02-life-tables.html"><a href="s02-life-tables.html#exercises-1"><i class="fa fa-check"></i><b>2.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="s02-life-tables.html"><a href="s02-life-tables.html#exercise-2.1"><i class="fa fa-check"></i>Exercise 2.1</a></li>
<li class="chapter" data-level="" data-path="s02-life-tables.html"><a href="s02-life-tables.html#exercise-2.2"><i class="fa fa-check"></i>Exercise 2.2</a></li>
<li class="chapter" data-level="" data-path="s02-life-tables.html"><a href="s02-life-tables.html#exercise-2.3"><i class="fa fa-check"></i>Exercise 2.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html"><i class="fa fa-check"></i><b>3</b> Age-structured matrix population models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#learning-goals-2"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#age-structured-growth"><i class="fa fa-check"></i><b>3.2</b> Age-structured growth</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#LeslieR"><i class="fa fa-check"></i><b>3.2.1</b> Creating a Leslie matrix in R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#census"><i class="fa fa-check"></i><b>3.3</b> Pre- and post-reproductive census</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#pre-reproductive-census"><i class="fa fa-check"></i><b>3.3.1</b> Pre-reproductive census</a></li>
<li class="chapter" data-level="3.3.2" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#post-reproductive-census"><i class="fa fa-check"></i><b>3.3.2</b> Post-reproductive census</a></li>
<li class="chapter" data-level="3.3.3" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#avoiding-mistakes"><i class="fa fa-check"></i><b>3.3.3</b> Avoiding mistakes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#life-cycle-graph"><i class="fa fa-check"></i><b>3.4</b> Life cycle graph</a></li>
<li class="chapter" data-level="3.5" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#projected-growth"><i class="fa fa-check"></i><b>3.5</b> Projected growth</a></li>
<li class="chapter" data-level="3.6" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#asymptotic"><i class="fa fa-check"></i><b>3.6</b> Asymptotic properties</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#projected"><i class="fa fa-check"></i><b>3.6.1</b> Calculations based on projected growth</a></li>
<li class="chapter" data-level="3.6.2" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#eigen"><i class="fa fa-check"></i><b>3.6.2</b> Calculations based on projection matrix</a></li>
<li class="chapter" data-level="3.6.3" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#lifetime"><i class="fa fa-check"></i><b>3.6.3</b> Life expectancy</a></li>
<li class="chapter" data-level="3.6.4" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#netrate"><i class="fa fa-check"></i><b>3.6.4</b> Lifetime reproduction</a></li>
<li class="chapter" data-level="3.6.5" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#gentime"><i class="fa fa-check"></i><b>3.6.5</b> Generation time</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#sensitivity-and-elasticity-of-lambda"><i class="fa fa-check"></i><b>3.7</b> Sensitivity and elasticity of <span class="math inline">\(\lambda\)</span></a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#sensitivity-to-matrix-elements"><i class="fa fa-check"></i><b>3.7.1</b> Sensitivity to matrix elements</a></li>
<li class="chapter" data-level="3.7.2" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#sensitivity-to-underlying-parameters"><i class="fa fa-check"></i><b>3.7.2</b> Sensitivity to underlying parameters</a></li>
<li class="chapter" data-level="3.7.3" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#elasticities"><i class="fa fa-check"></i><b>3.7.3</b> Elasticities</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#senescence"><i class="fa fa-check"></i><b>3.8</b> Senescence</a>
<ul>
<li class="chapter" data-level="" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#the-effect-of-extrinsic-mortality-on-senescence"><i class="fa fa-check"></i>The effect of extrinsic mortality on senescence</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#LTRE"><i class="fa fa-check"></i><b>3.9</b> Life table response experiments (LTRE)</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#general-description-of-ltre-approach"><i class="fa fa-check"></i><b>3.9.1</b> General description of LTRE approach</a></li>
<li class="chapter" data-level="3.9.2" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#ltre-and-sensitivity-analyses"><i class="fa fa-check"></i><b>3.9.2</b> LTRE and sensitivity analyses</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#exercises-2"><i class="fa fa-check"></i><b>3.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#exercise-3.1"><i class="fa fa-check"></i>Exercise 3.1</a></li>
<li class="chapter" data-level="" data-path="s03-MatrixModels.html"><a href="s03-MatrixModels.html#exercise-3.2"><i class="fa fa-check"></i>Exercise 3.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="s04-Stage.html"><a href="s04-Stage.html"><i class="fa fa-check"></i><b>4</b> Stage structured models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="s04-Stage.html"><a href="s04-Stage.html#learning-goals-3"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="s04-Stage.html"><a href="s04-Stage.html#general-stage-structured-matrix-model"><i class="fa fa-check"></i><b>4.2</b> General stage structured matrix model</a></li>
<li class="chapter" data-level="4.3" data-path="s04-Stage.html"><a href="s04-Stage.html#decomposing-mathbfu-and-mathbff"><i class="fa fa-check"></i><b>4.3</b> Decomposing <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{F}\)</span></a></li>
<li class="chapter" data-level="4.4" data-path="s04-Stage.html"><a href="s04-Stage.html#examples-of-stage-structured-models"><i class="fa fa-check"></i><b>4.4</b> Examples of stage structured models</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="s04-Stage.html"><a href="s04-Stage.html#lefkovitch-models"><i class="fa fa-check"></i><b>4.4.1</b> Lefkovitch models</a></li>
<li class="chapter" data-level="4.4.2" data-path="s04-Stage.html"><a href="s04-Stage.html#agestage"><i class="fa fa-check"></i><b>4.4.2</b> Age by stage models</a></li>
<li class="chapter" data-level="4.4.3" data-path="s04-Stage.html"><a href="s04-Stage.html#disease-models"><i class="fa fa-check"></i><b>4.4.3</b> Disease models</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="s04-Stage.html"><a href="s04-Stage.html#integral-projection-models-ipms"><i class="fa fa-check"></i><b>4.5</b> Integral projection models (IPMs)</a></li>
<li class="chapter" data-level="4.6" data-path="s04-Stage.html"><a href="s04-Stage.html#exercises-3"><i class="fa fa-check"></i><b>4.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="s04-Stage.html"><a href="s04-Stage.html#exercise-4.1"><i class="fa fa-check"></i>Exercise 4.1</a></li>
<li class="chapter" data-level="" data-path="s04-Stage.html"><a href="s04-Stage.html#exercise-4.2"><i class="fa fa-check"></i>Exercise 4.2</a></li>
<li class="chapter" data-level="" data-path="s04-Stage.html"><a href="s04-Stage.html#exercise-4.3"><i class="fa fa-check"></i>Exercise 4.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Stochasticity.html"><a href="Stochasticity.html"><i class="fa fa-check"></i><b>5</b> Stochasticity</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Stochasticity.html"><a href="Stochasticity.html#learning-goals-4"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="Stochasticity.html"><a href="Stochasticity.html#variable-vs-unpredictable-environments"><i class="fa fa-check"></i><b>5.2</b> Variable vs unpredictable environments</a></li>
<li class="chapter" data-level="5.3" data-path="Stochasticity.html"><a href="Stochasticity.html#the-lewontin-cohen-model"><i class="fa fa-check"></i><b>5.3</b> The Lewontin-Cohen model</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="Stochasticity.html"><a href="Stochasticity.html#defining-the-process"><i class="fa fa-check"></i><b>5.3.1</b> Defining the process</a></li>
<li class="chapter" data-level="5.3.2" data-path="Stochasticity.html"><a href="Stochasticity.html#the-stochastic-growth-rate"><i class="fa fa-check"></i><b>5.3.2</b> The stochastic growth rate</a></li>
<li class="chapter" data-level="5.3.3" data-path="Stochasticity.html"><a href="Stochasticity.html#arithmetic-and-geometric-mean"><i class="fa fa-check"></i><b>5.3.3</b> Arithmetic and geometric mean</a></li>
<li class="chapter" data-level="5.3.4" data-path="Stochasticity.html"><a href="Stochasticity.html#bet-hedging"><i class="fa fa-check"></i><b>5.3.4</b> Bet-hedging</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="Stochasticity.html"><a href="Stochasticity.html#stochastic-growth-of-structured-populations"><i class="fa fa-check"></i><b>5.4</b> Stochastic growth of structured populations</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="Stochasticity.html"><a href="Stochasticity.html#defining-the-process-1"><i class="fa fa-check"></i><b>5.4.1</b> Defining the process</a></li>
<li class="chapter" data-level="" data-path="Stochasticity.html"><a href="Stochasticity.html#plot-one-realization-of-the-process-1"><i class="fa fa-check"></i>Plot one realization of the process</a></li>
<li class="chapter" data-level="" data-path="Stochasticity.html"><a href="Stochasticity.html#plot-many-realizations-of-the-process-1"><i class="fa fa-check"></i>Plot many realizations of the process</a></li>
<li class="chapter" data-level="" data-path="Stochasticity.html"><a href="Stochasticity.html#plot-percentiles-from-many-realizations-1"><i class="fa fa-check"></i>Plot percentiles from many realizations</a></li>
<li class="chapter" data-level="5.4.2" data-path="Stochasticity.html"><a href="Stochasticity.html#stochastic-growth-rate"><i class="fa fa-check"></i><b>5.4.2</b> Stochastic growth rate</a></li>
<li class="chapter" data-level="5.4.3" data-path="Stochasticity.html"><a href="Stochasticity.html#small-noise-approximation"><i class="fa fa-check"></i><b>5.4.3</b> Small noise approximation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="Stochasticity.html"><a href="Stochasticity.html#exercises-4"><i class="fa fa-check"></i><b>5.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="Stochasticity.html"><a href="Stochasticity.html#exercise-5.1"><i class="fa fa-check"></i>Exercise 5.1</a></li>
<li class="chapter" data-level="" data-path="Stochasticity.html"><a href="Stochasticity.html#exercise-5.2"><i class="fa fa-check"></i>Exercise 5.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="id_06-references.html"><a href="id_06-references.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="s09-Solutions.html"><a href="s09-Solutions.html"><i class="fa fa-check"></i><b>A</b> Suggested solutions to exercises</a>
<ul>
<li class="chapter" data-level="A.1" data-path="s09-Solutions.html"><a href="s09-Solutions.html#chapter-1-exercises"><i class="fa fa-check"></i><b>A.1</b> Chapter 1 exercises</a>
<ul>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-1.1-1"><i class="fa fa-check"></i>Exercise 1.1</a></li>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-1.2-1"><i class="fa fa-check"></i>Exercise 1.2</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="s09-Solutions.html"><a href="s09-Solutions.html#chapter-2-exercises"><i class="fa fa-check"></i><b>A.2</b> Chapter 2 exercises</a>
<ul>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-2.1-1"><i class="fa fa-check"></i>Exercise 2.1</a></li>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-2.2-1"><i class="fa fa-check"></i>Exercise 2.2</a></li>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-2.3-1"><i class="fa fa-check"></i>Exercise 2.3</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="s09-Solutions.html"><a href="s09-Solutions.html#chapter-3-exercises"><i class="fa fa-check"></i><b>A.3</b> Chapter 3 exercises</a>
<ul>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-3.1-1"><i class="fa fa-check"></i>Exercise 3.1</a></li>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-3.2-1"><i class="fa fa-check"></i>Exercise 3.2</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="s09-Solutions.html"><a href="s09-Solutions.html#chapter-4-exercises"><i class="fa fa-check"></i><b>A.4</b> Chapter 4 exercises</a>
<ul>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-4.1-1"><i class="fa fa-check"></i>Exercise 4.1</a></li>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-4.2-1"><i class="fa fa-check"></i>Exercise 4.2</a></li>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-4.3-1"><i class="fa fa-check"></i>Exercise 4.3</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="s09-Solutions.html"><a href="s09-Solutions.html#chapter-5-exercises"><i class="fa fa-check"></i><b>A.5</b> Chapter 5 exercises</a>
<ul>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-5.1-1"><i class="fa fa-check"></i>Exercise 5.1</a></li>
<li class="chapter" data-level="" data-path="s09-Solutions.html"><a href="s09-Solutions.html#exercise-5.2-1"><i class="fa fa-check"></i>Exercise 5.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html"><i class="fa fa-check"></i><b>B</b> R code collection</a>
<ul>
<li class="chapter" data-level="B.1" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#life-tables"><i class="fa fa-check"></i><b>B.1</b> Life tables</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#net-reproductive-rate-r_0"><i class="fa fa-check"></i><b>B.1.1</b> Net reproductive rate <span class="math inline">\(R_0\)</span></a></li>
<li class="chapter" data-level="B.1.2" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#euler-lotka"><i class="fa fa-check"></i><b>B.1.2</b> Euler-Lotka</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#matrix-population-models"><i class="fa fa-check"></i><b>B.2</b> Matrix population models</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#create-leslie-matrix"><i class="fa fa-check"></i><b>B.2.1</b> Create Leslie matrix</a></li>
<li class="chapter" data-level="B.2.2" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#decompose-mathbfu-and-mathbff"><i class="fa fa-check"></i><b>B.2.2</b> Decompose <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{F}\)</span></a></li>
<li class="chapter" data-level="B.2.3" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#population-projection"><i class="fa fa-check"></i><b>B.2.3</b> Population projection</a></li>
<li class="chapter" data-level="B.2.4" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#long-term-growth-rate-stable-structure-and-reproductive-value"><i class="fa fa-check"></i><b>B.2.4</b> Long-term growth rate, stable structure and reproductive value</a></li>
<li class="chapter" data-level="B.2.5" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#life-expectancy"><i class="fa fa-check"></i><b>B.2.5</b> Life expectancy</a></li>
<li class="chapter" data-level="B.2.6" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#lifetime-reproduction"><i class="fa fa-check"></i><b>B.2.6</b> Lifetime reproduction</a></li>
<li class="chapter" data-level="B.2.7" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#generation-time"><i class="fa fa-check"></i><b>B.2.7</b> Generation time</a></li>
<li class="chapter" data-level="B.2.8" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#sensitivities-and-elasticities"><i class="fa fa-check"></i><b>B.2.8</b> Sensitivities and elasticities</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#stochastic-models"><i class="fa fa-check"></i><b>B.3</b> Stochastic models</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#arithmetic-and-geometric-mean-1"><i class="fa fa-check"></i><b>B.3.1</b> Arithmetic and geometric mean</a></li>
<li class="chapter" data-level="B.3.2" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#simulations-in-lewontin-cohen-model"><i class="fa fa-check"></i><b>B.3.2</b> Simulations in Lewontin-Cohen model</a></li>
<li class="chapter" data-level="B.3.3" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#simulations-of-stochastic-structured-model"><i class="fa fa-check"></i><b>B.3.3</b> Simulations of stochastic structured model</a></li>
<li class="chapter" data-level="B.3.4" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#estimate-stochastic-growth-rate"><i class="fa fa-check"></i><b>B.3.4</b> Estimate stochastic growth rate</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="s07-Code-Collection.html"><a href="s07-Code-Collection.html#parameters-and-matrices-for-the-songbird-example"><i class="fa fa-check"></i><b>B.4</b> Parameters and matrices for the songbird example</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Demographic methods in life history theory</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="s09-Solutions" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">A</span> Suggested solutions to exercises<a href="s09-Solutions.html#s09-Solutions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><br></p>
<div id="chapter-1-exercises" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">A.1</span> Chapter 1 exercises<a href="s09-Solutions.html#chapter-1-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise-1.1-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1.1<a href="s09-Solutions.html#exercise-1.1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Make R function for exponential growth:</li>
</ol>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="s09-Solutions.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda: Multiplicative growth rate</span></span>
<span id="cb66-2"><a href="s09-Solutions.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#N0: Initial population size</span></span>
<span id="cb66-3"><a href="s09-Solutions.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Tmax: Number of time steps</span></span>
<span id="cb66-4"><a href="s09-Solutions.html#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="s09-Solutions.html#cb66-5" aria-hidden="true" tabindex="-1"></a>Exp.growth <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, N0, Tmax){</span>
<span id="cb66-6"><a href="s09-Solutions.html#cb66-6" aria-hidden="true" tabindex="-1"></a>        N0<span class="sc">*</span>lambda<span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span>Tmax)</span>
<span id="cb66-7"><a href="s09-Solutions.html#cb66-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-8"><a href="s09-Solutions.html#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="s09-Solutions.html#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co">#test:</span></span>
<span id="cb66-10"><a href="s09-Solutions.html#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">Exp.growth</span>(<span class="at">lambda=</span><span class="fl">1.3</span>, <span class="at">N0=</span><span class="dv">10</span>, <span class="at">Tmax=</span><span class="dv">5</span>)        </span></code></pre></div>
<pre><code>## [1] 10.0000 13.0000 16.9000 21.9700 28.5610 37.1293</code></pre>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li>Plot population growth for different values of <span class="math inline">\(\lambda\)</span>:</li>
</ol>
<p><br></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="s09-Solutions.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make a vector of lambda values:</span></span>
<span id="cb68-2"><a href="s09-Solutions.html#cb68-2" aria-hidden="true" tabindex="-1"></a>lambdavec <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">5</span>, <span class="fl">1.5</span>, <span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb68-3"><a href="s09-Solutions.html#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="s09-Solutions.html#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Store growth results for each lambda value in a data frame:</span></span>
<span id="cb68-5"><a href="s09-Solutions.html#cb68-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">lambda=</span>lambdavec, <span class="at">Time=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb68-6"><a href="s09-Solutions.html#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambdavec)){</span>
<span id="cb68-7"><a href="s09-Solutions.html#cb68-7" aria-hidden="true" tabindex="-1"></a>        results<span class="sc">$</span>Popsize[results<span class="sc">$</span>lambda<span class="sc">==</span>lambdavec[i]] <span class="ot">&lt;-</span></span>
<span id="cb68-8"><a href="s09-Solutions.html#cb68-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">Exp.growth</span>(<span class="at">lambda=</span>lambdavec[i], </span>
<span id="cb68-9"><a href="s09-Solutions.html#cb68-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">N0=</span><span class="dv">10</span>,</span>
<span id="cb68-10"><a href="s09-Solutions.html#cb68-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">Tmax=</span><span class="dv">10</span>)</span>
<span id="cb68-11"><a href="s09-Solutions.html#cb68-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-12"><a href="s09-Solutions.html#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="s09-Solutions.html#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Store log population size (better for plotting)</span></span>
<span id="cb68-14"><a href="s09-Solutions.html#cb68-14" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>LogSize <span class="ot">&lt;-</span> <span class="fu">log</span>(results<span class="sc">$</span>Popsize)</span>
<span id="cb68-15"><a href="s09-Solutions.html#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="s09-Solutions.html#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot with ggplot:</span></span>
<span id="cb68-17"><a href="s09-Solutions.html#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results) <span class="sc">+</span> </span>
<span id="cb68-18"><a href="s09-Solutions.html#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>LogSize, <span class="at">col=</span>lambda, </span>
<span id="cb68-19"><a href="s09-Solutions.html#cb68-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">group=</span>lambda ), <span class="at">lwd=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb68-20"><a href="s09-Solutions.html#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb68-21"><a href="s09-Solutions.html#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>()<span class="sc">+</span></span>
<span id="cb68-22"><a href="s09-Solutions.html#cb68-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span> )<span class="sc">+</span> </span>
<span id="cb68-23"><a href="s09-Solutions.html#cb68-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Time&quot;</span>, <span class="at">y=</span><span class="fu">expression</span>(<span class="fu">ln</span>(N)),</span>
<span id="cb68-24"><a href="s09-Solutions.html#cb68-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">color=</span><span class="fu">expression</span>(lambda))<span class="sc">+</span> </span>
<span id="cb68-25"><a href="s09-Solutions.html#cb68-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, </span>
<span id="cb68-26"><a href="s09-Solutions.html#cb68-26" aria-hidden="true" tabindex="-1"></a>                                <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-1.png" width="576" /></p>
<p><br> <br></p>
</div>
<div id="exercise-1.2-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1.2<a href="s09-Solutions.html#exercise-1.2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><br></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>Value of <span class="math inline">\(\lambda\)</span>: If the population grows by 1<span class="math inline">\(\%\)</span> per day, that means <span class="math inline">\(\lambda\approx 1.01\)</span>, with a unit of days.</p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Doubling time: We denote the doubling time as <span class="math inline">\(t_2\)</span>. Inserting <span class="math inline">\(N=2N_0\)</span> in the equation of exponential growth, we get:</p>
<p><span class="math display">\[\begin{align*}
2N_0&amp;=N_0\lambda^{t_2}\\
\lambda^{t_2}&amp;=2 \\ t_2\ln\lambda&amp;=2\\
t_2&amp;=\frac{2}{\ln\lambda} =\frac{2}{\ln 1.01} \approx 201.  
\end{align*}\]</span></p>
<p>The population will take approximately 201 days to double in size.</p>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Population size after 1 year: One year is approximately 365 days, so with a starting populatoin of 100 individuals we get</p>
<p><span class="math display">\[N=100\cdot 1.01^{365}\approx 3778.\]</span>
<br></p>
<p>Plot population growth over a year:</p>
<p><br></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="s09-Solutions.html#cb69-1" aria-hidden="true" tabindex="-1"></a>sgrowth <span class="ot">&lt;-</span> <span class="fu">Exp.growth</span>(<span class="at">lambda=</span><span class="fl">1.01</span>, <span class="at">N0=</span><span class="dv">100</span>, <span class="at">Tmax=</span><span class="dv">365</span>)</span>
<span id="cb69-2"><a href="s09-Solutions.html#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="s09-Solutions.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Store as data frame for plotting:</span></span>
<span id="cb69-4"><a href="s09-Solutions.html#cb69-4" aria-hidden="true" tabindex="-1"></a>silverfish <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sgrowth, <span class="at">Time=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">365</span>)</span>
<span id="cb69-5"><a href="s09-Solutions.html#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="s09-Solutions.html#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot with ggplot:</span></span>
<span id="cb69-7"><a href="s09-Solutions.html#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(silverfish) <span class="sc">+</span> </span>
<span id="cb69-8"><a href="s09-Solutions.html#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>sgrowth), <span class="at">lwd=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb69-9"><a href="s09-Solutions.html#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb69-10"><a href="s09-Solutions.html#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Time&quot;</span>, <span class="at">y=</span><span class="st">&quot;Silverfish population&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-1.png" width="576" /></p>
<p><br><br></p>
</div>
</div>
<div id="chapter-2-exercises" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">A.2</span> Chapter 2 exercises<a href="s09-Solutions.html#chapter-2-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><br></p>
<div id="exercise-2.1-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2.1<a href="s09-Solutions.html#exercise-2.1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>The number of children includes boys and girls, so to get <span class="math inline">\(R_0\)</span> we divide by half (assuming equal sex ratio at birth). Using the approximation (<span class="math inline">\(\lambda\approx \exp\left(\frac{\ln R_0}{T_C}\right)\)</span>), we can add values of <span class="math inline">\(\lambda\)</span> to the table (here assuming a generatio ntime of <span class="math inline">\(T_C=25\)</span> or <span class="math inline">\(T_C=30\)</span>):</p>
<p><br></p>
<table>
<colgroup>
<col width="18%" />
<col width="27%" />
<col width="9%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Country</th>
<th align="center">Children per woman</th>
<th align="center"><span class="math inline">\(R_0\)</span></th>
<th align="center"><span class="math inline">\(\lambda_{25}\)</span></th>
<th align="center"><span class="math inline">\(\lambda_{30}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Mali</td>
<td align="center">5.8</td>
<td align="center">2.90</td>
<td align="center">1.044</td>
<td align="center">1.036</td>
</tr>
<tr class="even">
<td align="center">Tunisia</td>
<td align="center">2.2</td>
<td align="center">1.10</td>
<td align="center">1.004</td>
<td align="center">1.003</td>
</tr>
<tr class="odd">
<td align="center">Australia</td>
<td align="center">1.7</td>
<td align="center">0.85</td>
<td align="center">0.994</td>
<td align="center">0.995</td>
</tr>
<tr class="even">
<td align="center">Norway</td>
<td align="center">1.6</td>
<td align="center">0.80</td>
<td align="center">0.991</td>
<td align="center">0.993</td>
</tr>
<tr class="odd">
<td align="center">South Korea</td>
<td align="center">0.9</td>
<td align="center">0.45</td>
<td align="center">0.969</td>
<td align="center">0.974</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>As generation time <span class="math inline">\(T_C\)</span> increases, <span class="math inline">\(\lambda\)</span> increases if the population is declining (<span class="math inline">\(\lambda&lt;1\)</span>), but declines if the population is growing (note: this exercise ignores immigration and emigration so the value of <span class="math inline">\(\lambda\)</span> does not represent the real population trends in these countries.)</p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>To answer this question we use the values <span class="math inline">\(\lambda_{25}\)</span>, and apply the formula from exercise 1.2 to find the doubling time (<span class="math inline">\(t_{2}=2/\ln \lambda_{25}\)</span>):</p>
<p><br></p>
<table>
<colgroup>
<col width="18%" />
<col width="28%" />
<col width="9%" />
<col width="22%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Country</th>
<th align="center">Children per woman</th>
<th align="center"><span class="math inline">\(R_0\)</span></th>
<th align="center"><span class="math inline">\(\lambda_{25}\)</span></th>
<th align="center">Doubling time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Mali</td>
<td align="center">5.8</td>
<td align="center">2.90</td>
<td align="center">1.044</td>
<td align="center">46.961</td>
</tr>
<tr class="even">
<td align="center">Tunisia</td>
<td align="center">2.2</td>
<td align="center">1.10</td>
<td align="center">1.004</td>
<td align="center">524.603</td>
</tr>
<tr class="odd">
<td align="center">Australia</td>
<td align="center">1.7</td>
<td align="center">0.85</td>
<td align="center">0.994</td>
<td align="center">-307.656</td>
</tr>
<tr class="even">
<td align="center">Norway</td>
<td align="center">1.6</td>
<td align="center">0.80</td>
<td align="center">0.991</td>
<td align="center">-224.071</td>
</tr>
<tr class="odd">
<td align="center">South Korea</td>
<td align="center">0.9</td>
<td align="center">0.45</td>
<td align="center">0.969</td>
<td align="center">-62.617</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Declining populations (<span class="math inline">\(\lambda&lt;1\)</span>) get negative doubling rates. Naturally these populations cannot double in size with negative growth. The growing populations (<span class="math inline">\(\lambda&gt;1\)</span>) have a doubling time of 47 years (Mali) and 525 years (Tunisia).</p>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>The exponential growth model is too simple to describe long-term growth of human population sizes. It describes current trends of growth given the current rates of survival and fertility. Both survival and fertility change over time, and the annual population growth rate is not constant, but has declined over time in most countries. The generation time also varies much among populations and will change over time (as it is a function of the survival and fertility rates). In particular for countries that currently grow fast we should be careful with making long-term extrapolations based on the exponential growth model. Finally, this exercise ignores immigration and emigration, which can be a large factor affecting population growth.</p>
<p><br></p>
</div>
<div id="exercise-2.2-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2.2<a href="s09-Solutions.html#exercise-2.2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>The age at first reproduction is 3 years. This is the first age where <span class="math inline">\(m_x&gt;0\)</span> in the life table.</p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Creating the life table in R (here we use the function ´data.frame()´, other options can also be used, like <code>tibble()</code> from tidyverse):</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="s09-Solutions.html#cb70-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> </span>
<span id="cb70-2"><a href="s09-Solutions.html#cb70-2" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12376</span>, <span class="dv">4233</span>, <span class="dv">1790</span>, <span class="dv">340</span>, <span class="dv">268</span>)</span>
<span id="cb70-3"><a href="s09-Solutions.html#cb70-3" aria-hidden="true" tabindex="-1"></a>mx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.1</span>, <span class="fl">3.2</span>)</span>
<span id="cb70-4"><a href="s09-Solutions.html#cb70-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb70-5"><a href="s09-Solutions.html#cb70-5" aria-hidden="true" tabindex="-1"></a>PlantTable <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, nx, mx) </span></code></pre></div>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Adding vectors of cumulative survival probability <span class="math inline">\(l_x\)</span> and annual survival probability <span class="math inline">\(p_x\)</span> to the life table:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="s09-Solutions.html#cb71-1" aria-hidden="true" tabindex="-1"></a>lx <span class="ot">&lt;-</span> nx<span class="sc">/</span>nx[<span class="dv">1</span>] <span class="co">#divide all elements of nx by the first.</span></span>
<span id="cb71-2"><a href="s09-Solutions.html#cb71-2" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">c</span>(lx[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]<span class="sc">/</span>lx[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="dv">0</span>) <span class="co">#by definition the last value is zero.</span></span>
<span id="cb71-3"><a href="s09-Solutions.html#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="s09-Solutions.html#cb71-4" aria-hidden="true" tabindex="-1"></a>PlantTable<span class="sc">$</span>lx <span class="ot">&lt;-</span> lx</span>
<span id="cb71-5"><a href="s09-Solutions.html#cb71-5" aria-hidden="true" tabindex="-1"></a>PlantTable<span class="sc">$</span>px <span class="ot">&lt;-</span> px</span>
<span id="cb71-6"><a href="s09-Solutions.html#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="s09-Solutions.html#cb71-7" aria-hidden="true" tabindex="-1"></a>PlantTable</span></code></pre></div>
<pre><code>##   x    nx  mx         lx        px
## 1 0 12376 0.0 1.00000000 0.3420330
## 2 1  4233 0.0 0.34203297 0.4228679
## 3 2  1790 0.0 0.14463478 0.1899441
## 4 3   340 2.1 0.02747253 0.7882353
## 5 4   268 3.2 0.02165482 0.0000000</code></pre>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>Plots of each life table column (<span class="math inline">\(n_x\)</span>, <span class="math inline">\(l_x\)</span>, <span class="math inline">\(p_x\)</span>, <span class="math inline">\(m_x\)</span>) as a function of age <span class="math inline">\(x\)</span>:</p>
<p><br></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="s09-Solutions.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert to long table format for plotting:</span></span>
<span id="cb73-2"><a href="s09-Solutions.html#cb73-2" aria-hidden="true" tabindex="-1"></a>plant.long <span class="ot">&lt;-</span> PlantTable <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="s09-Solutions.html#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(nx, lx, px,  mx),</span>
<span id="cb73-4"><a href="s09-Solutions.html#cb73-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;VitalRates&quot;</span>, </span>
<span id="cb73-5"><a href="s09-Solutions.html#cb73-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb73-6"><a href="s09-Solutions.html#cb73-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb73-7"><a href="s09-Solutions.html#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plant.long) <span class="sc">+</span> </span>
<span id="cb73-8"><a href="s09-Solutions.html#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>Value, </span>
<span id="cb73-9"><a href="s09-Solutions.html#cb73-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span>VitalRates), <span class="at">lwd=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb73-10"><a href="s09-Solutions.html#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors4)<span class="sc">+</span></span>
<span id="cb73-11"><a href="s09-Solutions.html#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb73-12"><a href="s09-Solutions.html#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(VitalRates,</span>
<span id="cb73-13"><a href="s09-Solutions.html#cb73-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;nx&quot;</span>, <span class="st">&quot;lx&quot;</span> , <span class="st">&quot;px&quot;</span>, <span class="st">&quot;mx&quot;</span>)), </span>
<span id="cb73-14"><a href="s09-Solutions.html#cb73-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb73-15"><a href="s09-Solutions.html#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-16"><a href="s09-Solutions.html#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Age (year)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>)<span class="sc">+</span></span>
<span id="cb73-17"><a href="s09-Solutions.html#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-1.png" width="864" /></p>
<p><br></p>
<p>The shape of <span class="math inline">\(l_x\)</span> follows the decline in cohort size over age, as it should. The annual survival probability fluctuates between ages but is quite low in the first years until the plant starts to reproduce at age 3. From age 3 to 4 the survival probability is much higher, almost 0.8, but then no plants survive after age 4 (last reproduction). Since all remaining plants die in the final year, the plants likely invest all resources in reproduction this year, and fecundity is higher at the second reproduction.</p>
<p><br></p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<p>Mean lifetime reproduction <span class="math inline">\(R_0\)</span> from the life table:</p>
<p><br></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="s09-Solutions.html#cb74-1" aria-hidden="true" tabindex="-1"></a>R0_Plant <span class="ot">&lt;-</span> <span class="fu">sum</span>(PlantTable<span class="sc">$</span>lx<span class="sc">*</span>PlantTable<span class="sc">$</span>mx)</span>
<span id="cb74-2"><a href="s09-Solutions.html#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="s09-Solutions.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(R0_Plant, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.127</code></pre>
<p>The value of <span class="math inline">\(R_0\)</span> is very low. Each plant is replaced by only 0.13 new plants on average. This means that <span class="math inline">\(\lambda&lt;1\)</span>.</p>
<p><br></p>
<ol start="6" style="list-style-type: decimal">
<li></li>
</ol>
<p>Generation time <span class="math inline">\(T_C\)</span> from the life table:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="s09-Solutions.html#cb76-1" aria-hidden="true" tabindex="-1"></a>TC_Plant <span class="ot">&lt;-</span> <span class="fu">sum</span>(PlantTable<span class="sc">$</span>x<span class="sc">*</span>PlantTable<span class="sc">$</span>lx<span class="sc">*</span>PlantTable<span class="sc">$</span>mx)<span class="sc">/</span>R0_Plant</span>
<span id="cb76-2"><a href="s09-Solutions.html#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="s09-Solutions.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(TC_Plant, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 3.546</code></pre>
<p><br></p>
<p>This is the cohort generation time, and shows the average age at which the <span class="math inline">\(R_0\)</span> offspring are produced.</p>
<p>Approximation of <span class="math inline">\(\lambda\)</span> based on <span class="math inline">\(R_0\)</span> and <span class="math inline">\(T_C\)</span>:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="s09-Solutions.html#cb78-1" aria-hidden="true" tabindex="-1"></a>lambda_Plant <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(R0_Plant)<span class="sc">/</span>TC_Plant)</span>
<span id="cb78-2"><a href="s09-Solutions.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#round(lambda_Plant, digits=3)</span></span></code></pre></div>
<p>Thus, the population growth rate is very low at <span class="math inline">\(\lambda\approx\)</span> 0.559. Almost half the population is lost each year.</p>
<p><br></p>
<ol start="7" style="list-style-type: decimal">
<li></li>
</ol>
<p>Solving the Euler-Lotka equation for <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="s09-Solutions.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rearranging the Euler-Lotka function </span></span>
<span id="cb79-2"><a href="s09-Solutions.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#to get an expression equal to zero:</span></span>
<span id="cb79-3"><a href="s09-Solutions.html#cb79-3" aria-hidden="true" tabindex="-1"></a>EulerLotka <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, x, lx, mx){</span>
<span id="cb79-4"><a href="s09-Solutions.html#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(lambda<span class="sc">^</span>(<span class="sc">-</span>x)<span class="sc">*</span>lx<span class="sc">*</span>mx)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb79-5"><a href="s09-Solutions.html#cb79-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-6"><a href="s09-Solutions.html#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="s09-Solutions.html#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Define search range for lambda in uniroot</span></span>
<span id="cb79-8"><a href="s09-Solutions.html#cb79-8" aria-hidden="true" tabindex="-1"></a>lambda.range <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb79-9"><a href="s09-Solutions.html#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="s09-Solutions.html#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply uniroot to find lambda, store the result</span></span>
<span id="cb79-11"><a href="s09-Solutions.html#cb79-11" aria-hidden="true" tabindex="-1"></a>lambda_Plant2 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(EulerLotka, </span>
<span id="cb79-12"><a href="s09-Solutions.html#cb79-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x=</span>PlantTable<span class="sc">$</span>x, </span>
<span id="cb79-13"><a href="s09-Solutions.html#cb79-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">lx=</span>PlantTable<span class="sc">$</span>lx, </span>
<span id="cb79-14"><a href="s09-Solutions.html#cb79-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mx=</span>PlantTable<span class="sc">$</span>mx,</span>
<span id="cb79-15"><a href="s09-Solutions.html#cb79-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">interval=</span>lambda.range)<span class="sc">$</span>root</span>
<span id="cb79-16"><a href="s09-Solutions.html#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="s09-Solutions.html#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="co">#round(lambda_Plant2, digits=3)</span></span></code></pre></div>
<p>The value calculated from the Euler-Lotka equation is <span class="math inline">\(\lambda\approx\)</span> 0.565, a bit higher than the approximated value.</p>
<p><br></p>
</div>
<div id="exercise-2.3-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2.3<a href="s09-Solutions.html#exercise-2.3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>According to table <a href="s02-life-tables.html#tab:tablebird">2.1</a>, the fecundity values of age 2 and 3 are <span class="math inline">\(m_2=3\)</span> and <span class="math inline">\(m_3=6\)</span>. To get the clutch size these values should be multiplied by 2 (assuming equal sex ratio), and divided by the survival probability. This gives an average clutch size of <span class="math inline">\(M_2=3\cdot2/0.9=6.67\)</span> eggs at age 3, and <span class="math inline">\(M_2=6\cdot2/0.9=13.33\)</span> eggs at age 4.</p>
<p>Thus, older parents produce larger clutches than younger ones, in this (fictive) example.</p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Under the assumptions of the Lack clutch, the trade-off is defined as <span class="math inline">\(c=\frac{1}{2N_e^*}\)</span>. At age 2, the Lack clutch size is 6.67 and we thus get <span class="math inline">\(c=\frac{1}{2\cdot6.67}\approx 0.074\)</span>. At age 3 the Lack clutch size is 13.33 and the trade-off is <span class="math inline">\(c=\frac{1}{2\cdot13.33}\approx 0.038\)</span>. Remember that the stronger the trade-off, the lower the clutch size. If the clutch size at each age is determined by this trade-off only (as the Lack clutch assumes), this means that the trade-off is reduced with age for this example. In reality, physical and behavioral constraints also limit clutch size of young versus older birds, in particular in first-time breeders versus experienced breeders.</p>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>To solve this we use the Euler-Lotka-equation, and insert the information we have (the value of <span class="math inline">\(\lambda=1.07\)</span> is calculated in the example for the Euler-Lotka equation):</p>
<p><span class="math display">\[\begin{align*}
\sum_x \lambda^{-x}l_xm_x&amp;=1\\
\lambda^{-3}l_3m_3&amp;=1\\
1.07^{-3}0.108m_3&amp;=1\\
m_3&amp;=1.07^{3}/0.108 \approx 11.34.
\end{align*}\]</span></p>
<p>Thus, the fecundity of the related species is higher, which makes sense since it only reproduces at age 3 while still having the same fitness as the example bird.</p>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>In Cole’s paradox, the semelparous species only needs one more offspring per clutch to get the same fitness as the iteroparous species. The result of the previous question tells us that the semelparous bird needs a much larger clutch size to match the fitness of the iteroparous species (or example species), so clearly semelparity is not as ‘cheap’ here as in Cole’s example.</p>
<p>Cole assumed a survival probability of 1 for the iteroparous species, and that both species reproduced from year 1, neither of which apply to the two bird species here. In both species there is a difference between juveniles and adults (juveniles do not reproduce), also not fitting the assumptions in Cole’s paradox.</p>
<p><br><br></p>
</div>
</div>
<div id="chapter-3-exercises" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">A.3</span> Chapter 3 exercises<a href="s09-Solutions.html#chapter-3-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><br></p>
<div id="exercise-3.1-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3.1<a href="s09-Solutions.html#exercise-3.1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><br></p>
<p>Life cycle for the bird example, with post-reproductive census:</p>
<p><img src="LifeCycleAgePost.jpg" width="60%" /></p>
<p><br></p>
<p>Note that each age class is numbered from 1 to 3, although they correspond to actual age 0 to 2 in this case.</p>
<p><br></p>
</div>
<div id="exercise-3.2-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3.2<a href="s09-Solutions.html#exercise-3.2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><br></p>
<div id="pre-reproductive-census-1" class="section level4 unnumbered hasAnchor">
<h4>Pre-reproductive census:<a href="s09-Solutions.html#pre-reproductive-census-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><br></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>Life cycle graph of plant:</p>
<p><img src="LifeCyclePlantPRE.jpg" width="60%" /></p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Vectors of fertility and survival coefficients:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="s09-Solutions.html#cb80-1" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> PlantTable<span class="sc">$</span>px</span>
<span id="cb80-2"><a href="s09-Solutions.html#cb80-2" aria-hidden="true" tabindex="-1"></a>mx <span class="ot">&lt;-</span> PlantTable<span class="sc">$</span>mx</span>
<span id="cb80-3"><a href="s09-Solutions.html#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="s09-Solutions.html#cb80-4" aria-hidden="true" tabindex="-1"></a>fertility.plant <span class="ot">&lt;-</span> px[<span class="dv">1</span>]<span class="sc">*</span>mx[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] </span>
<span id="cb80-5"><a href="s09-Solutions.html#cb80-5" aria-hidden="true" tabindex="-1"></a>survival.plant <span class="ot">&lt;-</span> px[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] </span></code></pre></div>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Define <span class="math inline">\(\mathbf{A}\)</span>, <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{F}\)</span>:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="s09-Solutions.html#cb81-1" aria-hidden="true" tabindex="-1"></a>AmatPlant <span class="ot">&lt;-</span> <span class="fu">Create.Amat</span>(<span class="at">Svec=</span>survival.plant, </span>
<span id="cb81-2"><a href="s09-Solutions.html#cb81-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Fvec=</span>fertility.plant)</span>
<span id="cb81-3"><a href="s09-Solutions.html#cb81-3" aria-hidden="true" tabindex="-1"></a>FmatPlant <span class="ot">&lt;-</span> UmatPlant <span class="ot">&lt;-</span> AmatPlant</span>
<span id="cb81-4"><a href="s09-Solutions.html#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="s09-Solutions.html#cb81-5" aria-hidden="true" tabindex="-1"></a>FmatPlant[<span class="sc">-</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb81-6"><a href="s09-Solutions.html#cb81-6" aria-hidden="true" tabindex="-1"></a>UmatPlant[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb81-7"><a href="s09-Solutions.html#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="s09-Solutions.html#cb81-8" aria-hidden="true" tabindex="-1"></a>AmatPlant</span></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]     [,4]
## [1,] 0.0000000 0.0000000 0.7182692 1.094505
## [2,] 0.4228679 0.0000000 0.0000000 0.000000
## [3,] 0.0000000 0.1899441 0.0000000 0.000000
## [4,] 0.0000000 0.0000000 0.7882353 0.000000</code></pre>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>Project age classes over 30 time steps:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="s09-Solutions.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Return matrix of projected growth of each age class:</span></span>
<span id="cb83-2"><a href="s09-Solutions.html#cb83-2" aria-hidden="true" tabindex="-1"></a>Pop.plant <span class="ot">&lt;-</span> <span class="fu">projection</span>(<span class="at">MatA=</span>AmatPlant, </span>
<span id="cb83-3"><a href="s09-Solutions.html#cb83-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n0=</span><span class="fu">rep</span>(<span class="dv">10</span>, <span class="dv">4</span>), </span>
<span id="cb83-4"><a href="s09-Solutions.html#cb83-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Tmax=</span><span class="dv">30</span>)</span>
<span id="cb83-5"><a href="s09-Solutions.html#cb83-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb83-6"><a href="s09-Solutions.html#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format for plotting:</span></span>
<span id="cb83-7"><a href="s09-Solutions.html#cb83-7" aria-hidden="true" tabindex="-1"></a>Pop.plant.long <span class="ot">&lt;-</span> Pop.plant <span class="sc">%&gt;%</span> </span>
<span id="cb83-8"><a href="s09-Solutions.html#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="sc">-</span>time), </span>
<span id="cb83-9"><a href="s09-Solutions.html#cb83-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;AgeClass&quot;</span>, </span>
<span id="cb83-10"><a href="s09-Solutions.html#cb83-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb83-11"><a href="s09-Solutions.html#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="s09-Solutions.html#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot</span></span>
<span id="cb83-13"><a href="s09-Solutions.html#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Pop.plant.long) <span class="sc">+</span> </span>
<span id="cb83-14"><a href="s09-Solutions.html#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>time,<span class="at">y=</span>Value, <span class="at">col=</span>AgeClass, </span>
<span id="cb83-15"><a href="s09-Solutions.html#cb83-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype=</span>AgeClass), <span class="at">lwd=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb83-16"><a href="s09-Solutions.html#cb83-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-17"><a href="s09-Solutions.html#cb83-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))<span class="sc">+</span> </span>
<span id="cb83-18"><a href="s09-Solutions.html#cb83-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb83-19"><a href="s09-Solutions.html#cb83-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Time (year)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Age class size&quot;</span>)<span class="sc">+</span>  </span>
<span id="cb83-20"><a href="s09-Solutions.html#cb83-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-1.png" width="864" /></p>
<p><br></p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<p>Calculate <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(R_0\)</span> and <span class="math inline">\(G\)</span> using the matrices:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="s09-Solutions.html#cb84-1" aria-hidden="true" tabindex="-1"></a>res.plant <span class="ot">&lt;-</span> <span class="fu">uvlambda</span>(AmatPlant)</span>
<span id="cb84-2"><a href="s09-Solutions.html#cb84-2" aria-hidden="true" tabindex="-1"></a>lambda.plant <span class="ot">&lt;-</span> res.plant<span class="sc">$</span>lambda</span>
<span id="cb84-3"><a href="s09-Solutions.html#cb84-3" aria-hidden="true" tabindex="-1"></a>R0.plant <span class="ot">&lt;-</span> <span class="fu">R0function</span>(UmatPlant, </span>
<span id="cb84-4"><a href="s09-Solutions.html#cb84-4" aria-hidden="true" tabindex="-1"></a>                       FmatPlant)<span class="sc">$</span>R0</span>
<span id="cb84-5"><a href="s09-Solutions.html#cb84-5" aria-hidden="true" tabindex="-1"></a>G.plant <span class="ot">&lt;-</span> <span class="fu">GenTime</span>(AmatPlant, </span>
<span id="cb84-6"><a href="s09-Solutions.html#cb84-6" aria-hidden="true" tabindex="-1"></a>                   FmatPlant)</span>
<span id="cb84-7"><a href="s09-Solutions.html#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="s09-Solutions.html#cb84-8" aria-hidden="true" tabindex="-1"></a>ResVec <span class="ot">&lt;-</span> <span class="fu">c</span>(lambda.plant, </span>
<span id="cb84-9"><a href="s09-Solutions.html#cb84-9" aria-hidden="true" tabindex="-1"></a>            R0.plant, </span>
<span id="cb84-10"><a href="s09-Solutions.html#cb84-10" aria-hidden="true" tabindex="-1"></a>            G.plant) </span>
<span id="cb84-11"><a href="s09-Solutions.html#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ResVec) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lambda&quot;</span>, <span class="st">&quot;R0&quot;</span>, <span class="st">&quot;G&quot;</span>)</span>
<span id="cb84-12"><a href="s09-Solutions.html#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ResVec,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## lambda     R0      G 
##  0.565  0.127  3.680</code></pre>
<p><br></p>
<p>These are approximately the same values as found from the life table. The generation time is slightly different because it is not the same measure. For the life table calculations we used the cohort generation time, while for the matrix model we used the mean age of mothers at the stable distribution.</p>
<p><br></p>
<ol start="6" style="list-style-type: decimal">
<li></li>
</ol>
<p>Calculate and plot <span class="math inline">\(\mathbf{u}\)</span> and <span class="math inline">\(\mathbf{v}\)</span>:</p>
<p>These values were calculated in the previous point using the R function <code>uvlambda()</code>. To plot them:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="s09-Solutions.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create data frame for plotting</span></span>
<span id="cb86-2"><a href="s09-Solutions.html#cb86-2" aria-hidden="true" tabindex="-1"></a>plantframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;AgeClass&quot;</span><span class="ot">=</span><span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), </span>
<span id="cb86-3"><a href="s09-Solutions.html#cb86-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;u&quot;</span><span class="ot">=</span>res.plant<span class="sc">$</span>u, </span>
<span id="cb86-4"><a href="s09-Solutions.html#cb86-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;v&quot;</span><span class="ot">=</span><span class="fu">t</span>(res.plant<span class="sc">$</span>v))</span>
<span id="cb86-5"><a href="s09-Solutions.html#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="s09-Solutions.html#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format for plotting:</span></span>
<span id="cb86-7"><a href="s09-Solutions.html#cb86-7" aria-hidden="true" tabindex="-1"></a>plantframe.long <span class="ot">&lt;-</span> plantframe <span class="sc">%&gt;%</span> </span>
<span id="cb86-8"><a href="s09-Solutions.html#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(u,v),</span>
<span id="cb86-9"><a href="s09-Solutions.html#cb86-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Vector&quot;</span>, </span>
<span id="cb86-10"><a href="s09-Solutions.html#cb86-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb86-11"><a href="s09-Solutions.html#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="s09-Solutions.html#cb86-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb86-13"><a href="s09-Solutions.html#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot</span></span>
<span id="cb86-14"><a href="s09-Solutions.html#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plantframe.long) <span class="sc">+</span> </span>
<span id="cb86-15"><a href="s09-Solutions.html#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>AgeClass, <span class="at">y=</span>Value, </span>
<span id="cb86-16"><a href="s09-Solutions.html#cb86-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span>AgeClass ), <span class="at">lwd=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb86-17"><a href="s09-Solutions.html#cb86-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb86-18"><a href="s09-Solutions.html#cb86-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Vector),<span class="at">ncol=</span><span class="dv">2</span>,</span>
<span id="cb86-19"><a href="s09-Solutions.html#cb86-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb86-20"><a href="s09-Solutions.html#cb86-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors4)<span class="sc">+</span> </span>
<span id="cb86-21"><a href="s09-Solutions.html#cb86-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Age class&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>)<span class="sc">+</span></span>
<span id="cb86-22"><a href="s09-Solutions.html#cb86-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" width="864" /></p>
<p><br></p>
<p>The stable age structure tells us the proportion of individuals in each age class when the population has reached the stable growth phase. In this case the stable age structure shows a higher proportion of individuals in age class 4 than in age class 3. This is uncommon for age structured populations (usually the stable age structure declines with age), and is due to the extremely low value of <span class="math inline">\(\lambda\)</span>.</p>
<p>The reproductive values tell us how much individuals in each age class will contribute to the future population, relative to other age classes (when the population has reached the stable growth phase). In this case the reproductive value is highest in age class 3, followed by age class 4, the two reproductive classes.</p>
<p><br></p>
<ol start="7" style="list-style-type: decimal">
<li></li>
</ol>
<p>Increase fecundity by factor <span class="math inline">\(c\)</span> to get <span class="math inline">\(\lambda&gt;1\)</span>: Based on trial and error (apply the code several times for different values of c) we find the value of c that increases the fecundity enough to get lambda &gt;1:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="s09-Solutions.html#cb87-1" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="co">#Updated through trial and error </span></span>
<span id="cb87-2"><a href="s09-Solutions.html#cb87-2" aria-hidden="true" tabindex="-1"></a>AmatPlantNew <span class="ot">&lt;-</span> <span class="fu">Create.Amat</span>(<span class="at">Svec=</span>px[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>], </span>
<span id="cb87-3"><a href="s09-Solutions.html#cb87-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Fvec=</span>px[<span class="dv">1</span>]<span class="sc">*</span>mx[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]<span class="sc">*</span>C)</span>
<span id="cb87-4"><a href="s09-Solutions.html#cb87-4" aria-hidden="true" tabindex="-1"></a>FmatPlantNew <span class="ot">&lt;-</span> UmatPlantNew <span class="ot">&lt;-</span> AmatPlantNew</span>
<span id="cb87-5"><a href="s09-Solutions.html#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="s09-Solutions.html#cb87-6" aria-hidden="true" tabindex="-1"></a>FmatPlantNew[<span class="sc">-</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb87-7"><a href="s09-Solutions.html#cb87-7" aria-hidden="true" tabindex="-1"></a>UmatPlantNew[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb87-8"><a href="s09-Solutions.html#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="s09-Solutions.html#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="fu">uvlambda</span>(AmatPlantNew)<span class="sc">$</span>lambda</span></code></pre></div>
<pre><code>## [1] 1.00446</code></pre>
<p>With a multiplying factor of 8 (increasing fecundity 8 times) we can get <span class="math inline">\(\lambda\)</span> over 1. Calculate the other parameters and return in vector:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="s09-Solutions.html#cb89-1" aria-hidden="true" tabindex="-1"></a>res.plantNew <span class="ot">&lt;-</span> <span class="fu">uvlambda</span>(AmatPlantNew)</span>
<span id="cb89-2"><a href="s09-Solutions.html#cb89-2" aria-hidden="true" tabindex="-1"></a>lambda.plantNew <span class="ot">&lt;-</span> res.plantNew<span class="sc">$</span>lambda</span>
<span id="cb89-3"><a href="s09-Solutions.html#cb89-3" aria-hidden="true" tabindex="-1"></a>R0.plantNew <span class="ot">&lt;-</span> <span class="fu">R0function</span>(UmatPlantNew, </span>
<span id="cb89-4"><a href="s09-Solutions.html#cb89-4" aria-hidden="true" tabindex="-1"></a>                          FmatPlantNew)<span class="sc">$</span>R0</span>
<span id="cb89-5"><a href="s09-Solutions.html#cb89-5" aria-hidden="true" tabindex="-1"></a>G.plantNew <span class="ot">&lt;-</span> <span class="fu">GenTime</span>(AmatPlantNew, </span>
<span id="cb89-6"><a href="s09-Solutions.html#cb89-6" aria-hidden="true" tabindex="-1"></a>                      FmatPlantNew)</span>
<span id="cb89-7"><a href="s09-Solutions.html#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="s09-Solutions.html#cb89-8" aria-hidden="true" tabindex="-1"></a>ResVecNew <span class="ot">&lt;-</span> <span class="fu">c</span>(lambda.plantNew,</span>
<span id="cb89-9"><a href="s09-Solutions.html#cb89-9" aria-hidden="true" tabindex="-1"></a>               R0.plantNew, </span>
<span id="cb89-10"><a href="s09-Solutions.html#cb89-10" aria-hidden="true" tabindex="-1"></a>               G.plantNew)  </span>
<span id="cb89-11"><a href="s09-Solutions.html#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ResVecNew) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lambda&quot;</span>, <span class="st">&quot;R0&quot;</span>, <span class="st">&quot;G&quot;</span>)</span>
<span id="cb89-12"><a href="s09-Solutions.html#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ResVecNew,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## lambda     R0      G 
##  1.004  1.016  3.545</code></pre>
<p>Compared to before, <span class="math inline">\(R_0\)</span> has increased a lot (it is now &gt;1 which it has to be because <span class="math inline">\(\lambda&gt;1\)</span>), while the generation time has only moderately changed, showing a slight decrease (thus the average age of mothers has decreased slightly).</p>
<p>Plot the new stable structure and reproductive values:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="s09-Solutions.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create data frame for plotting</span></span>
<span id="cb91-2"><a href="s09-Solutions.html#cb91-2" aria-hidden="true" tabindex="-1"></a>plantframeNew <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;AgeClass&quot;</span><span class="ot">=</span><span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), </span>
<span id="cb91-3"><a href="s09-Solutions.html#cb91-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;u&quot;</span><span class="ot">=</span>res.plantNew<span class="sc">$</span>u,</span>
<span id="cb91-4"><a href="s09-Solutions.html#cb91-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;v&quot;</span><span class="ot">=</span><span class="fu">t</span>(res.plantNew<span class="sc">$</span>v))</span>
<span id="cb91-5"><a href="s09-Solutions.html#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="s09-Solutions.html#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format for plotting:</span></span>
<span id="cb91-7"><a href="s09-Solutions.html#cb91-7" aria-hidden="true" tabindex="-1"></a>plantframeNew.long <span class="ot">&lt;-</span> plantframeNew <span class="sc">%&gt;%</span> </span>
<span id="cb91-8"><a href="s09-Solutions.html#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(u,v),</span>
<span id="cb91-9"><a href="s09-Solutions.html#cb91-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Vector&quot;</span>, </span>
<span id="cb91-10"><a href="s09-Solutions.html#cb91-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb91-11"><a href="s09-Solutions.html#cb91-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-12"><a href="s09-Solutions.html#cb91-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb91-13"><a href="s09-Solutions.html#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot</span></span>
<span id="cb91-14"><a href="s09-Solutions.html#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plantframeNew.long) <span class="sc">+</span> </span>
<span id="cb91-15"><a href="s09-Solutions.html#cb91-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>AgeClass, <span class="at">y=</span>Value, <span class="at">fill=</span>AgeClass ), <span class="at">lwd=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb91-16"><a href="s09-Solutions.html#cb91-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb91-17"><a href="s09-Solutions.html#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Vector),<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb91-18"><a href="s09-Solutions.html#cb91-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors4)<span class="sc">+</span>  </span>
<span id="cb91-19"><a href="s09-Solutions.html#cb91-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Age class&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>)<span class="sc">+</span>  </span>
<span id="cb91-20"><a href="s09-Solutions.html#cb91-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span> )  </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-1.png" width="864" /></p>
<p><br></p>
<p>Now that <span class="math inline">\(\lambda&gt;1\)</span>, the stable age structure is declining over age. Compared to before it is also more skewed towards the younger age classes. The reproductive value is still highest in age class 3, but the difference is now larger between the two reproducing classes and the young non-reproducing classes.</p>
<p><br></p>
<ol start="8" style="list-style-type: decimal">
<li></li>
</ol>
<p>Increase survival by factor <span class="math inline">\(c\)</span> to get <span class="math inline">\(\lambda&gt;1\)</span>:</p>
<p>Based on trial and error (apply the code several times for different values of c) we find the value of c that increases the survival enough to get lambda &gt;1 (NB: Note that we need to update both the fertility and survival coefficients):</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="s09-Solutions.html#cb92-1" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fl">1.8</span> <span class="co">#Updated through trial and error </span></span>
<span id="cb92-2"><a href="s09-Solutions.html#cb92-2" aria-hidden="true" tabindex="-1"></a>AmatPlantNew2 <span class="ot">&lt;-</span> <span class="fu">Create.Amat</span>(<span class="at">Svec=</span>px[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]<span class="sc">*</span>C, </span>
<span id="cb92-3"><a href="s09-Solutions.html#cb92-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Fvec=</span>px[<span class="dv">1</span>]<span class="sc">*</span>mx[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]<span class="sc">*</span>C)</span>
<span id="cb92-4"><a href="s09-Solutions.html#cb92-4" aria-hidden="true" tabindex="-1"></a>FmatPlantNew2 <span class="ot">&lt;-</span> UmatPlantNew2 <span class="ot">&lt;-</span> AmatPlantNew2</span>
<span id="cb92-5"><a href="s09-Solutions.html#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="s09-Solutions.html#cb92-6" aria-hidden="true" tabindex="-1"></a>FmatPlantNew2[<span class="sc">-</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb92-7"><a href="s09-Solutions.html#cb92-7" aria-hidden="true" tabindex="-1"></a>UmatPlantNew2[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb92-8"><a href="s09-Solutions.html#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="s09-Solutions.html#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="fu">uvlambda</span>(AmatPlantNew2)<span class="sc">$</span>lambda</span></code></pre></div>
<pre><code>## [1] 1.016965</code></pre>
<p>With a multiplying factor of 1.8 for the survival vector to get <span class="math inline">\(\lambda\)</span> over 1, however this means that the survival probability of the third age class is <span class="math inline">\(&gt;1\)</span>, which is not realistic/possible.</p>
</div>
<div id="post-reproductive-census-1" class="section level4 unnumbered hasAnchor">
<h4>Post-reproductive census:<a href="s09-Solutions.html#post-reproductive-census-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>Life cycle graph of the plant:</p>
<p><img src="LifeCyclePlantPost.jpg" width="60%" /></p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Vectors of fertility and survival coefficients:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="s09-Solutions.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#corresponding to age class 1:4, age 0:3:</span></span>
<span id="cb94-2"><a href="s09-Solutions.html#cb94-2" aria-hidden="true" tabindex="-1"></a>fertility.plant.post <span class="ot">&lt;-</span> px[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]<span class="sc">*</span>mx[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] </span>
<span id="cb94-3"><a href="s09-Solutions.html#cb94-3" aria-hidden="true" tabindex="-1"></a>survival.plant.post <span class="ot">&lt;-</span> <span class="fu">c</span>(px[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],<span class="dv">0</span>) </span></code></pre></div>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Define <span class="math inline">\(\mathbf{A}\)</span>, <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{F}\)</span>:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="s09-Solutions.html#cb95-1" aria-hidden="true" tabindex="-1"></a>AmatPlant.post <span class="ot">&lt;-</span> <span class="fu">Create.Amat</span>(<span class="at">Svec=</span>survival.plant.post,</span>
<span id="cb95-2"><a href="s09-Solutions.html#cb95-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Fvec=</span>fertility.plant.post)</span>
<span id="cb95-3"><a href="s09-Solutions.html#cb95-3" aria-hidden="true" tabindex="-1"></a>FmatPlant.post <span class="ot">&lt;-</span> </span>
<span id="cb95-4"><a href="s09-Solutions.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  UmatPlant.post <span class="ot">&lt;-</span> AmatPlant.post</span>
<span id="cb95-5"><a href="s09-Solutions.html#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="s09-Solutions.html#cb95-6" aria-hidden="true" tabindex="-1"></a>FmatPlant.post[<span class="sc">-</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb95-7"><a href="s09-Solutions.html#cb95-7" aria-hidden="true" tabindex="-1"></a>UmatPlant.post[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb95-8"><a href="s09-Solutions.html#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="s09-Solutions.html#cb95-9" aria-hidden="true" tabindex="-1"></a>AmatPlant.post</span></code></pre></div>
<pre><code>##          [,1]      [,2]      [,3]     [,4]
## [1,] 0.000000 0.0000000 0.3988827 2.522353
## [2,] 0.342033 0.0000000 0.0000000 0.000000
## [3,] 0.000000 0.4228679 0.0000000 0.000000
## [4,] 0.000000 0.0000000 0.1899441 0.000000</code></pre>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>Project age classes over 30 time steps:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="s09-Solutions.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Return matrix of projected growth of each age class:</span></span>
<span id="cb97-2"><a href="s09-Solutions.html#cb97-2" aria-hidden="true" tabindex="-1"></a>Pop.plant.post <span class="ot">&lt;-</span> <span class="fu">projection</span>(<span class="at">MatA=</span>AmatPlant.post, </span>
<span id="cb97-3"><a href="s09-Solutions.html#cb97-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">n0=</span><span class="fu">rep</span>(<span class="dv">10</span>, <span class="dv">4</span>), </span>
<span id="cb97-4"><a href="s09-Solutions.html#cb97-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Tmax=</span><span class="dv">30</span>)</span>
<span id="cb97-5"><a href="s09-Solutions.html#cb97-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb97-6"><a href="s09-Solutions.html#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format for plotting:</span></span>
<span id="cb97-7"><a href="s09-Solutions.html#cb97-7" aria-hidden="true" tabindex="-1"></a>Pop.plant.long.post <span class="ot">&lt;-</span> Pop.plant.post <span class="sc">%&gt;%</span> </span>
<span id="cb97-8"><a href="s09-Solutions.html#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="sc">-</span>time),</span>
<span id="cb97-9"><a href="s09-Solutions.html#cb97-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;AgeClass&quot;</span>, </span>
<span id="cb97-10"><a href="s09-Solutions.html#cb97-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb97-11"><a href="s09-Solutions.html#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="s09-Solutions.html#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot</span></span>
<span id="cb97-13"><a href="s09-Solutions.html#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Pop.plant.long.post) <span class="sc">+</span> </span>
<span id="cb97-14"><a href="s09-Solutions.html#cb97-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>time,<span class="at">y=</span>Value, <span class="at">col=</span>AgeClass,</span>
<span id="cb97-15"><a href="s09-Solutions.html#cb97-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype=</span>AgeClass), <span class="at">lwd=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb97-16"><a href="s09-Solutions.html#cb97-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb97-17"><a href="s09-Solutions.html#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>colors4)<span class="sc">+</span> </span>
<span id="cb97-18"><a href="s09-Solutions.html#cb97-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">+</span>  </span>
<span id="cb97-19"><a href="s09-Solutions.html#cb97-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Time (year)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Age class size&quot;</span>)<span class="sc">+</span> </span>
<span id="cb97-20"><a href="s09-Solutions.html#cb97-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-65-1.png" width="864" /></p>
<p><br></p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<p>Calculate <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(R_0\)</span> and <span class="math inline">\(G\)</span> using the matrices:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="s09-Solutions.html#cb98-1" aria-hidden="true" tabindex="-1"></a>res.plant.post <span class="ot">&lt;-</span> <span class="fu">uvlambda</span>(AmatPlant.post)</span>
<span id="cb98-2"><a href="s09-Solutions.html#cb98-2" aria-hidden="true" tabindex="-1"></a>lambda.plant.post <span class="ot">&lt;-</span> res.plant.post<span class="sc">$</span>lambda</span>
<span id="cb98-3"><a href="s09-Solutions.html#cb98-3" aria-hidden="true" tabindex="-1"></a>R0.plant.post <span class="ot">&lt;-</span> <span class="fu">R0function</span>(UmatPlant.post, </span>
<span id="cb98-4"><a href="s09-Solutions.html#cb98-4" aria-hidden="true" tabindex="-1"></a>                            FmatPlant.post)<span class="sc">$</span>R0</span>
<span id="cb98-5"><a href="s09-Solutions.html#cb98-5" aria-hidden="true" tabindex="-1"></a>G.plant.post <span class="ot">&lt;-</span> <span class="fu">GenTime</span>(AmatPlant.post, </span>
<span id="cb98-6"><a href="s09-Solutions.html#cb98-6" aria-hidden="true" tabindex="-1"></a>                        FmatPlant.post)</span>
<span id="cb98-7"><a href="s09-Solutions.html#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="s09-Solutions.html#cb98-8" aria-hidden="true" tabindex="-1"></a>ResVec.post <span class="ot">&lt;-</span> <span class="fu">c</span>(lambda.plant.post,</span>
<span id="cb98-9"><a href="s09-Solutions.html#cb98-9" aria-hidden="true" tabindex="-1"></a>                 R0.plant.post, </span>
<span id="cb98-10"><a href="s09-Solutions.html#cb98-10" aria-hidden="true" tabindex="-1"></a>                 G.plant.post) <span class="co">#Store results</span></span>
<span id="cb98-11"><a href="s09-Solutions.html#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ResVec.post) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lambda&quot;</span>, <span class="st">&quot;R0&quot;</span>, <span class="st">&quot;G&quot;</span>)</span>
<span id="cb98-12"><a href="s09-Solutions.html#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ResVec.post,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## lambda     R0      G 
##  0.565  0.127  3.680</code></pre>
<p>The values are the same as with the pre-reproductive census model.</p>
<p><br></p>
<ol start="6" style="list-style-type: decimal">
<li></li>
</ol>
<p>Calculate and plot <span class="math inline">\(\mathbf{u}\)</span> and <span class="math inline">\(\mathbf{v}\)</span>:</p>
<p>These values were calculated in the previous point using the R function <code>uvlambda()</code>. To plot them:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="s09-Solutions.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create data frame for plotting</span></span>
<span id="cb100-2"><a href="s09-Solutions.html#cb100-2" aria-hidden="true" tabindex="-1"></a>plantframe.post <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;AgeClass&quot;</span><span class="ot">=</span><span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), </span>
<span id="cb100-3"><a href="s09-Solutions.html#cb100-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;u&quot;</span><span class="ot">=</span>res.plant.post<span class="sc">$</span>u, </span>
<span id="cb100-4"><a href="s09-Solutions.html#cb100-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;v&quot;</span><span class="ot">=</span><span class="fu">t</span>(res.plant.post<span class="sc">$</span>v))</span>
<span id="cb100-5"><a href="s09-Solutions.html#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="s09-Solutions.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format for plotting:</span></span>
<span id="cb100-7"><a href="s09-Solutions.html#cb100-7" aria-hidden="true" tabindex="-1"></a>plantframe.post.long <span class="ot">&lt;-</span> plantframe.post <span class="sc">%&gt;%</span> </span>
<span id="cb100-8"><a href="s09-Solutions.html#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(u,v),</span>
<span id="cb100-9"><a href="s09-Solutions.html#cb100-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Vector&quot;</span>, </span>
<span id="cb100-10"><a href="s09-Solutions.html#cb100-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb100-11"><a href="s09-Solutions.html#cb100-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-12"><a href="s09-Solutions.html#cb100-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb100-13"><a href="s09-Solutions.html#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot</span></span>
<span id="cb100-14"><a href="s09-Solutions.html#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plantframe.post.long) <span class="sc">+</span> </span>
<span id="cb100-15"><a href="s09-Solutions.html#cb100-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>AgeClass, <span class="at">y=</span>Value, </span>
<span id="cb100-16"><a href="s09-Solutions.html#cb100-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span>AgeClass ), <span class="at">lwd=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb100-17"><a href="s09-Solutions.html#cb100-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb100-18"><a href="s09-Solutions.html#cb100-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Vector),<span class="at">ncol=</span><span class="dv">2</span>,</span>
<span id="cb100-19"><a href="s09-Solutions.html#cb100-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb100-20"><a href="s09-Solutions.html#cb100-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors4)<span class="sc">+</span></span>
<span id="cb100-21"><a href="s09-Solutions.html#cb100-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Age class&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>)<span class="sc">+</span>  </span>
<span id="cb100-22"><a href="s09-Solutions.html#cb100-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-67-1.png" width="864" /></p>
<p><br></p>
<p>Now the age classes correspond to actual age 0 to 3, in contrast to the pre-reproductive model where they correspond to age 1 to 4. The stable age structure and reproductive values look different here, since the classes represent other ages. Here the highest reproductive value is found for age class 4, corresponding to age 3. This is in line with the result from the pre-reproductive model where the highest reproductive value was found in age class 3, there corresponding to age 3.</p>
<p><br></p>
<ol start="7" style="list-style-type: decimal">
<li></li>
</ol>
<p>Increase fecundity by factor <span class="math inline">\(c\)</span> to get <span class="math inline">\(\lambda&gt;1\)</span>:</p>
<p>Based on trial and error (apply the code several times for different values of c) we find the value of c that increases the fecundity enough to get lambda &gt;1:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="s09-Solutions.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Updated through trial and error :</span></span>
<span id="cb101-2"><a href="s09-Solutions.html#cb101-2" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="dv">8</span>  </span>
<span id="cb101-3"><a href="s09-Solutions.html#cb101-3" aria-hidden="true" tabindex="-1"></a>AmatPlantNew.post <span class="ot">&lt;-</span> <span class="fu">Create.Amat</span>(</span>
<span id="cb101-4"><a href="s09-Solutions.html#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Svec=</span> <span class="fu">c</span>(px[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],<span class="dv">0</span>), </span>
<span id="cb101-5"><a href="s09-Solutions.html#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fvec=</span>px[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]<span class="sc">*</span>mx[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]<span class="sc">*</span>C)</span>
<span id="cb101-6"><a href="s09-Solutions.html#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="s09-Solutions.html#cb101-7" aria-hidden="true" tabindex="-1"></a>FmatPlantNew.post <span class="ot">&lt;-</span> </span>
<span id="cb101-8"><a href="s09-Solutions.html#cb101-8" aria-hidden="true" tabindex="-1"></a>  UmatPlantNew.post <span class="ot">&lt;-</span> AmatPlantNew.post</span>
<span id="cb101-9"><a href="s09-Solutions.html#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="s09-Solutions.html#cb101-10" aria-hidden="true" tabindex="-1"></a>FmatPlantNew.post[<span class="sc">-</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb101-11"><a href="s09-Solutions.html#cb101-11" aria-hidden="true" tabindex="-1"></a>UmatPlantNew.post[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb101-12"><a href="s09-Solutions.html#cb101-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-13"><a href="s09-Solutions.html#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="fu">uvlambda</span>(AmatPlantNew.post)<span class="sc">$</span>lambda</span></code></pre></div>
<pre><code>## [1] 1.00446</code></pre>
<p><br></p>
<p>We need the same factor of 8 (increasing fecundity 8 times) to get <span class="math inline">\(\lambda\)</span> over 1.</p>
<p>The other parameters</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="s09-Solutions.html#cb103-1" aria-hidden="true" tabindex="-1"></a>res.plantNew.post <span class="ot">&lt;-</span> <span class="fu">uvlambda</span>(AmatPlantNew.post)</span>
<span id="cb103-2"><a href="s09-Solutions.html#cb103-2" aria-hidden="true" tabindex="-1"></a>lambda.plantNew.post <span class="ot">&lt;-</span> res.plantNew.post<span class="sc">$</span>lambda</span>
<span id="cb103-3"><a href="s09-Solutions.html#cb103-3" aria-hidden="true" tabindex="-1"></a>R0.plantNew.post <span class="ot">&lt;-</span> <span class="fu">R0function</span>(UmatPlantNew.post, </span>
<span id="cb103-4"><a href="s09-Solutions.html#cb103-4" aria-hidden="true" tabindex="-1"></a>                               FmatPlantNew.post)<span class="sc">$</span>R0</span>
<span id="cb103-5"><a href="s09-Solutions.html#cb103-5" aria-hidden="true" tabindex="-1"></a>G.plantNew.post <span class="ot">&lt;-</span> <span class="fu">GenTime</span>(AmatPlantNew.post, </span>
<span id="cb103-6"><a href="s09-Solutions.html#cb103-6" aria-hidden="true" tabindex="-1"></a>                           FmatPlantNew.post)</span>
<span id="cb103-7"><a href="s09-Solutions.html#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="s09-Solutions.html#cb103-8" aria-hidden="true" tabindex="-1"></a>ResVecNew.post <span class="ot">&lt;-</span> <span class="fu">c</span>(lambda.plantNew.post, </span>
<span id="cb103-9"><a href="s09-Solutions.html#cb103-9" aria-hidden="true" tabindex="-1"></a>                    R0.plantNew.post, </span>
<span id="cb103-10"><a href="s09-Solutions.html#cb103-10" aria-hidden="true" tabindex="-1"></a>                    G.plantNew.post)  </span>
<span id="cb103-11"><a href="s09-Solutions.html#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ResVecNew.post) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lambda&quot;</span>, <span class="st">&quot;R0&quot;</span>, <span class="st">&quot;G&quot;</span>)</span>
<span id="cb103-12"><a href="s09-Solutions.html#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ResVecNew.post,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## lambda     R0      G 
##  1.004  1.016  3.545</code></pre>
<p><br></p>
<p>These values are the same as in the pre-reproductive (updated) model.</p>
<p>Plot new stable structure and reproductive values:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="s09-Solutions.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create data frame for plotting</span></span>
<span id="cb105-2"><a href="s09-Solutions.html#cb105-2" aria-hidden="true" tabindex="-1"></a>plantframeNew.post <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;AgeClass&quot;</span><span class="ot">=</span><span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), </span>
<span id="cb105-3"><a href="s09-Solutions.html#cb105-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;u&quot;</span><span class="ot">=</span>res.plantNew.post<span class="sc">$</span>u, </span>
<span id="cb105-4"><a href="s09-Solutions.html#cb105-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;v&quot;</span><span class="ot">=</span><span class="fu">t</span>(res.plantNew.post<span class="sc">$</span>v))</span>
<span id="cb105-5"><a href="s09-Solutions.html#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="s09-Solutions.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format for plotting:</span></span>
<span id="cb105-7"><a href="s09-Solutions.html#cb105-7" aria-hidden="true" tabindex="-1"></a>plantframeNew.post.long <span class="ot">&lt;-</span> plantframeNew.post <span class="sc">%&gt;%</span> </span>
<span id="cb105-8"><a href="s09-Solutions.html#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(u,v),</span>
<span id="cb105-9"><a href="s09-Solutions.html#cb105-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Vector&quot;</span>, </span>
<span id="cb105-10"><a href="s09-Solutions.html#cb105-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb105-11"><a href="s09-Solutions.html#cb105-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb105-12"><a href="s09-Solutions.html#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot:</span></span>
<span id="cb105-13"><a href="s09-Solutions.html#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plantframeNew.post.long) <span class="sc">+</span> </span>
<span id="cb105-14"><a href="s09-Solutions.html#cb105-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>AgeClass, <span class="at">y=</span>Value, </span>
<span id="cb105-15"><a href="s09-Solutions.html#cb105-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span>AgeClass ), <span class="at">lwd=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb105-16"><a href="s09-Solutions.html#cb105-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb105-17"><a href="s09-Solutions.html#cb105-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Vector),<span class="at">ncol=</span><span class="dv">2</span>,</span>
<span id="cb105-18"><a href="s09-Solutions.html#cb105-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb105-19"><a href="s09-Solutions.html#cb105-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors4) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-70-1.png" width="864" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="s09-Solutions.html#cb106-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Age class&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>) </span></code></pre></div>
<pre><code>## $x
## [1] &quot;Age class&quot;
## 
## $y
## [1] &quot;Value&quot;
## 
## attr(,&quot;class&quot;)
## [1] &quot;labels&quot;</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="s09-Solutions.html#cb108-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)  </span></code></pre></div>
<pre><code>## List of 1
##  $ legend.position: chr &quot;none&quot;
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;theme&quot; &quot;gg&quot;
##  - attr(*, &quot;complete&quot;)= logi FALSE
##  - attr(*, &quot;validate&quot;)= logi TRUE</code></pre>
<p><br></p>
<p>Compared to before, the stable structure is more skewed towards the younger age classes. The reproductive value is still highest in age class 4, but the difference is now larger between the classes.</p>
<p><br></p>
<ol start="8" style="list-style-type: decimal">
<li></li>
</ol>
<p>Increase survival by factor <span class="math inline">\(c\)</span> to get <span class="math inline">\(\lambda&gt;1\)</span>:</p>
<p>Based on trial and error (apply the code several times for different values of c) we find the value of c that increases the fecundity enough to get lambda &gt;1:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="s09-Solutions.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Updated through trial and error :</span></span>
<span id="cb110-2"><a href="s09-Solutions.html#cb110-2" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fl">1.8</span> </span>
<span id="cb110-3"><a href="s09-Solutions.html#cb110-3" aria-hidden="true" tabindex="-1"></a>AmatPlantNew2.post <span class="ot">&lt;-</span> <span class="fu">Create.Amat</span>(</span>
<span id="cb110-4"><a href="s09-Solutions.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Svec=</span> <span class="fu">c</span>(px[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],<span class="dv">0</span>)<span class="sc">*</span>C,</span>
<span id="cb110-5"><a href="s09-Solutions.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fvec=</span>px[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]<span class="sc">*</span>mx[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]<span class="sc">*</span>C)</span>
<span id="cb110-6"><a href="s09-Solutions.html#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="s09-Solutions.html#cb110-7" aria-hidden="true" tabindex="-1"></a>FmatPlantNew2.post <span class="ot">&lt;-</span> </span>
<span id="cb110-8"><a href="s09-Solutions.html#cb110-8" aria-hidden="true" tabindex="-1"></a>  UmatPlantNew2.post <span class="ot">&lt;-</span> AmatPlantNew2.post</span>
<span id="cb110-9"><a href="s09-Solutions.html#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="s09-Solutions.html#cb110-10" aria-hidden="true" tabindex="-1"></a>FmatPlantNew2.post[<span class="sc">-</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb110-11"><a href="s09-Solutions.html#cb110-11" aria-hidden="true" tabindex="-1"></a>UmatPlantNew2.post[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb110-12"><a href="s09-Solutions.html#cb110-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-13"><a href="s09-Solutions.html#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="fu">uvlambda</span>(AmatPlantNew2.post)<span class="sc">$</span>lambda</span></code></pre></div>
<pre><code>## [1] 1.016965</code></pre>
<p>We still need a multiplying factor of 1.8 for survival to get <span class="math inline">\(\lambda\)</span> over 1, and we get the same problem with <span class="math inline">\(p_3&gt;1\)</span>.</p>
<p><br></p>
<p><br></p>
</div>
</div>
</div>
<div id="chapter-4-exercises" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">A.4</span> Chapter 4 exercises<a href="s09-Solutions.html#chapter-4-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><br></p>
<div id="exercise-4.1-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 4.1<a href="s09-Solutions.html#exercise-4.1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<center>
<p><img src="LifeCycleEx41.jpg" width="60%" /></p>
</center>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>To separate out the vectors of survival probabilities and fertility coefficients, we need the matrices <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{F}\)</span>, instead of only <span class="math inline">\(\mathbf{A}\)</span>. If we assume that the first row of <span class="math inline">\(\mathbf{A}\)</span> represent fertilities and the others represent survival and transitions, we can decompose <span class="math inline">\(\mathbf{A}\)</span> (note that in general this is not an assumption we can make):</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="s09-Solutions.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the projection matrices in R:</span></span>
<span id="cb112-2"><a href="s09-Solutions.html#cb112-2" aria-hidden="true" tabindex="-1"></a>Amat1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>), </span>
<span id="cb112-3"><a href="s09-Solutions.html#cb112-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">2</span>,.<span class="dv">7</span>))</span>
<span id="cb112-4"><a href="s09-Solutions.html#cb112-4" aria-hidden="true" tabindex="-1"></a>Amat2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">9</span>, <span class="dv">0</span>),</span>
<span id="cb112-5"><a href="s09-Solutions.html#cb112-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">9</span>), </span>
<span id="cb112-6"><a href="s09-Solutions.html#cb112-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb112-7"><a href="s09-Solutions.html#cb112-7" aria-hidden="true" tabindex="-1"></a>Amat3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">9</span>, <span class="dv">0</span>), </span>
<span id="cb112-8"><a href="s09-Solutions.html#cb112-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">8</span>, .<span class="dv">1</span>, .<span class="dv">7</span>), </span>
<span id="cb112-9"><a href="s09-Solutions.html#cb112-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">5</span>, .<span class="dv">7</span>, .<span class="dv">2</span>))</span>
<span id="cb112-10"><a href="s09-Solutions.html#cb112-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-11"><a href="s09-Solutions.html#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create matrices U and F for each example, </span></span>
<span id="cb112-12"><a href="s09-Solutions.html#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co">#under the assumption mentioned:</span></span>
<span id="cb112-13"><a href="s09-Solutions.html#cb112-13" aria-hidden="true" tabindex="-1"></a>Umat1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb112-14"><a href="s09-Solutions.html#cb112-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">7</span>))</span>
<span id="cb112-15"><a href="s09-Solutions.html#cb112-15" aria-hidden="true" tabindex="-1"></a>Umat2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">9</span>, <span class="dv">0</span>), </span>
<span id="cb112-16"><a href="s09-Solutions.html#cb112-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">9</span>), </span>
<span id="cb112-17"><a href="s09-Solutions.html#cb112-17" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb112-18"><a href="s09-Solutions.html#cb112-18" aria-hidden="true" tabindex="-1"></a>Umat3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">9</span>, <span class="dv">0</span>), </span>
<span id="cb112-19"><a href="s09-Solutions.html#cb112-19" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">1</span>, .<span class="dv">7</span>), </span>
<span id="cb112-20"><a href="s09-Solutions.html#cb112-20" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">7</span>, .<span class="dv">2</span>))</span>
<span id="cb112-21"><a href="s09-Solutions.html#cb112-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-22"><a href="s09-Solutions.html#cb112-22" aria-hidden="true" tabindex="-1"></a>Fmat1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>), </span>
<span id="cb112-23"><a href="s09-Solutions.html#cb112-23" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb112-24"><a href="s09-Solutions.html#cb112-24" aria-hidden="true" tabindex="-1"></a>Fmat2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb112-25"><a href="s09-Solutions.html#cb112-25" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb112-26"><a href="s09-Solutions.html#cb112-26" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb112-27"><a href="s09-Solutions.html#cb112-27" aria-hidden="true" tabindex="-1"></a>Fmat3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb112-28"><a href="s09-Solutions.html#cb112-28" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb112-29"><a href="s09-Solutions.html#cb112-29" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb112-30"><a href="s09-Solutions.html#cb112-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-31"><a href="s09-Solutions.html#cb112-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply the decompose functions to decompose </span></span>
<span id="cb112-32"><a href="s09-Solutions.html#cb112-32" aria-hidden="true" tabindex="-1"></a><span class="co">#each matrix (shown here for the first only)</span></span>
<span id="cb112-33"><a href="s09-Solutions.html#cb112-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-34"><a href="s09-Solutions.html#cb112-34" aria-hidden="true" tabindex="-1"></a><span class="fu">DecomposeU</span>(Umat1)</span></code></pre></div>
<pre><code>## $Gmat
##      [,1] [,2]
## [1,]    0    0
## [2,]    1    1
## 
## $Survival
## [1] 1.0 0.7</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="s09-Solutions.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DecomposeF</span>(Fmat1)</span></code></pre></div>
<pre><code>## $Qmat
##      [,1] [,2]
## [1,]    1    1
## [2,]    0    0
## 
## $Fertility
## [1] 0.5 2.0</code></pre>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>The first matrix has only two stages, and the numbers suggest reproduction occurs in both, as well as transition of individuals. This could be a model for two habitats with migration between them.</p>
<p>The middle matrix is a typical Leslie matrix. Note that only the last age class reproduces, so this is a semelparous life history.</p>
<p>The third matrix has many transitions, but based on the numbers the first stage seems to be an offspring stage. The two other stages both reproduce, and there are transitions between them. They could represent two habitats, or two size classes (where both growing and shrinking is possible).</p>
<p><br></p>
</div>
<div id="exercise-4.2-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 4.2<a href="s09-Solutions.html#exercise-4.2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><br></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>Define the fertility matrix <span class="math inline">\(\mathbf{F}\)</span>, the survival matrix <span class="math inline">\(\mathbf{U}\)</span>, and the projection matrix <span class="math inline">\(\mathbf{A}\)</span>:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="s09-Solutions.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Define vectors</span></span>
<span id="cb116-2"><a href="s09-Solutions.html#cb116-2" aria-hidden="true" tabindex="-1"></a>Pvec<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.158</span>, <span class="fl">0.545</span>, <span class="fl">0.539</span>, <span class="fl">0.162</span>, <span class="fl">0.008</span>, <span class="fl">0.136</span>, <span class="fl">0.8</span>)</span>
<span id="cb116-3"><a href="s09-Solutions.html#cb116-3" aria-hidden="true" tabindex="-1"></a>Gvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.722</span>,<span class="fl">0.244</span>, <span class="fl">0.231</span>, <span class="fl">0.788</span> , <span class="fl">0.792</span>, <span class="fl">0.664</span>,<span class="dv">0</span>)</span>
<span id="cb116-4"><a href="s09-Solutions.html#cb116-4" aria-hidden="true" tabindex="-1"></a>Fvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.355</span>, <span class="dv">0</span>, <span class="fl">5.568</span>, <span class="dv">0</span>)</span>
<span id="cb116-5"><a href="s09-Solutions.html#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="s09-Solutions.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Create matrices:</span></span>
<span id="cb116-7"><a href="s09-Solutions.html#cb116-7" aria-hidden="true" tabindex="-1"></a>Umat.isopod <span class="ot">&lt;-</span> Fmat.isopod <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">7</span>)</span>
<span id="cb116-8"><a href="s09-Solutions.html#cb116-8" aria-hidden="true" tabindex="-1"></a>Umat.isopod[<span class="fu">row</span>(Umat.isopod) <span class="sc">==</span> <span class="fu">col</span>(Umat.isopod) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> Gvec[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb116-9"><a href="s09-Solutions.html#cb116-9" aria-hidden="true" tabindex="-1"></a>Umat.isopod[<span class="fu">row</span>(Umat.isopod) <span class="sc">==</span> <span class="fu">col</span>(Umat.isopod)] <span class="ot">&lt;-</span> Pvec</span>
<span id="cb116-10"><a href="s09-Solutions.html#cb116-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-11"><a href="s09-Solutions.html#cb116-11" aria-hidden="true" tabindex="-1"></a>Fmat.isopod[<span class="dv">1</span>,] <span class="ot">&lt;-</span> Fvec</span>
<span id="cb116-12"><a href="s09-Solutions.html#cb116-12" aria-hidden="true" tabindex="-1"></a>Amat.isopod <span class="ot">&lt;-</span> Umat.isopod <span class="sc">+</span> Fmat.isopod</span></code></pre></div>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Decompose the matrices <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{F}\)</span>, plot the stage-specific fertility and survival probability:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="s09-Solutions.html#cb117-1" aria-hidden="true" tabindex="-1"></a>Svec.isopod <span class="ot">&lt;-</span> <span class="fu">DecomposeU</span>(Umat.isopod)<span class="sc">$</span>Survival</span>
<span id="cb117-2"><a href="s09-Solutions.html#cb117-2" aria-hidden="true" tabindex="-1"></a>Fvec.isopod <span class="ot">&lt;-</span> <span class="fu">DecomposeF</span>(Fmat.isopod)<span class="sc">$</span>Fertility</span>
<span id="cb117-3"><a href="s09-Solutions.html#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="s09-Solutions.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Make a data frame for plotting:</span></span>
<span id="cb117-5"><a href="s09-Solutions.html#cb117-5" aria-hidden="true" tabindex="-1"></a>frame.isopod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Stage&quot;</span><span class="ot">=</span><span class="fu">as.factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb117-6"><a href="s09-Solutions.html#cb117-6" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Survival&quot;</span><span class="ot">=</span>Svec.isopod,</span>
<span id="cb117-7"><a href="s09-Solutions.html#cb117-7" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Fertility&quot;</span><span class="ot">=</span>Fvec.isopod)</span>
<span id="cb117-8"><a href="s09-Solutions.html#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="s09-Solutions.html#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format:</span></span>
<span id="cb117-10"><a href="s09-Solutions.html#cb117-10" aria-hidden="true" tabindex="-1"></a>frame.isopod.long <span class="ot">&lt;-</span> frame.isopod <span class="sc">%&gt;%</span> </span>
<span id="cb117-11"><a href="s09-Solutions.html#cb117-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(Survival, Fertility), </span>
<span id="cb117-12"><a href="s09-Solutions.html#cb117-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;VitalRates&quot;</span>, </span>
<span id="cb117-13"><a href="s09-Solutions.html#cb117-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb117-14"><a href="s09-Solutions.html#cb117-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb117-15"><a href="s09-Solutions.html#cb117-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-16"><a href="s09-Solutions.html#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot with ggplot:</span></span>
<span id="cb117-17"><a href="s09-Solutions.html#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(frame.isopod.long) <span class="sc">+</span> </span>
<span id="cb117-18"><a href="s09-Solutions.html#cb117-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>Stage, <span class="at">y=</span>Value, <span class="at">fill=</span>VitalRates ))<span class="sc">+</span></span>
<span id="cb117-19"><a href="s09-Solutions.html#cb117-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors2)<span class="sc">+</span></span>
<span id="cb117-20"><a href="s09-Solutions.html#cb117-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(VitalRates,</span>
<span id="cb117-21"><a href="s09-Solutions.html#cb117-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Survival&quot;</span>, <span class="st">&quot;Fertility&quot;</span>)), </span>
<span id="cb117-22"><a href="s09-Solutions.html#cb117-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb117-23"><a href="s09-Solutions.html#cb117-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb117-24"><a href="s09-Solutions.html#cb117-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Stage&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>)<span class="sc">+</span></span>
<span id="cb117-25"><a href="s09-Solutions.html#cb117-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-75-1.png" width="576" /></p>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Calculate <span class="math inline">\(\lambda\)</span>, the stable stage structure and reproductive values, and plot the result:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="s09-Solutions.html#cb118-1" aria-hidden="true" tabindex="-1"></a>res.isopod <span class="ot">&lt;-</span> <span class="fu">uvlambda</span>(Amat.isopod)</span>
<span id="cb118-2"><a href="s09-Solutions.html#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="s09-Solutions.html#cb118-3" aria-hidden="true" tabindex="-1"></a>lambda.isopod <span class="ot">&lt;-</span> res.isopod<span class="sc">$</span>lam</span>
<span id="cb118-4"><a href="s09-Solutions.html#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="s09-Solutions.html#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Make a data frame for plotting:</span></span>
<span id="cb118-6"><a href="s09-Solutions.html#cb118-6" aria-hidden="true" tabindex="-1"></a>resframe.isopod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Stage&quot;</span><span class="ot">=</span><span class="fu">as.factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb118-7"><a href="s09-Solutions.html#cb118-7" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;u&quot;</span><span class="ot">=</span>res.isopod<span class="sc">$</span>u, </span>
<span id="cb118-8"><a href="s09-Solutions.html#cb118-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;v&quot;</span><span class="ot">=</span><span class="fu">as.vector</span>(res.isopod<span class="sc">$</span>v))</span>
<span id="cb118-9"><a href="s09-Solutions.html#cb118-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-10"><a href="s09-Solutions.html#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format:</span></span>
<span id="cb118-11"><a href="s09-Solutions.html#cb118-11" aria-hidden="true" tabindex="-1"></a>resframe.isopod.long <span class="ot">&lt;-</span> resframe.isopod <span class="sc">%&gt;%</span> </span>
<span id="cb118-12"><a href="s09-Solutions.html#cb118-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(u, v), <span class="at">names_to =</span> <span class="st">&quot;uv&quot;</span>, </span>
<span id="cb118-13"><a href="s09-Solutions.html#cb118-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb118-14"><a href="s09-Solutions.html#cb118-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb118-15"><a href="s09-Solutions.html#cb118-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-16"><a href="s09-Solutions.html#cb118-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot with ggplot:</span></span>
<span id="cb118-17"><a href="s09-Solutions.html#cb118-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resframe.isopod.long) <span class="sc">+</span> </span>
<span id="cb118-18"><a href="s09-Solutions.html#cb118-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>Stage, <span class="at">y=</span>Value, <span class="at">fill=</span>uv ))<span class="sc">+</span></span>
<span id="cb118-19"><a href="s09-Solutions.html#cb118-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors2)<span class="sc">+</span></span>
<span id="cb118-20"><a href="s09-Solutions.html#cb118-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(uv, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;u&quot;</span>, <span class="st">&quot;v&quot;</span>)), </span>
<span id="cb118-21"><a href="s09-Solutions.html#cb118-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb118-22"><a href="s09-Solutions.html#cb118-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb118-23"><a href="s09-Solutions.html#cb118-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Stage&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>)<span class="sc">+</span></span>
<span id="cb118-24"><a href="s09-Solutions.html#cb118-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-76-1.png" width="576" /></p>
<p>The growth rate is <span class="math inline">\(\lambda\approx\)</span> 1.0745 per month. Per year the growth rate is <span class="math inline">\(\lambda^12\approx\)</span> 2.3683. Thus, the annual growth rate is high, more than doubling the population each year. However, this matrix model assumes that the population can reproduce every month, and reaches a stable structure with individuals in the reproductive stages each month, while in reality there are only two main breeding periods per year <span class="citation">(<a href="#ref-Kammenga1" role="doc-biblioref">Kammenga, Gestel, and Hornung 2001</a>)</span>. Thus, while the model can describe the life of one cohort reasonably well (e.g. we can use the projection matrix to project the growth over a year or two starting with a cohort in stage 1), it likely overestimates the population growth rate.</p>
<p>Note that the reproductive value is zero in the final stage, because this is a post-reproductive stage. It does not contribute to population growth, but can still be relevant to consider in the model.</p>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>Write function that returns the projection matrix as a function of the input vectors:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="s09-Solutions.html#cb119-1" aria-hidden="true" tabindex="-1"></a>A.isopod <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">PV=</span>Pvec, <span class="at">GV=</span>Gvec, <span class="at">FV=</span>Fvec){</span>
<span id="cb119-2"><a href="s09-Solutions.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  Umat.isopod <span class="ot">&lt;-</span> Fmat.isopod <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">7</span>)</span>
<span id="cb119-3"><a href="s09-Solutions.html#cb119-3" aria-hidden="true" tabindex="-1"></a>  Umat.isopod[<span class="fu">row</span>(Umat.isopod) <span class="sc">==</span> <span class="fu">col</span>(Umat.isopod) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> GV[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb119-4"><a href="s09-Solutions.html#cb119-4" aria-hidden="true" tabindex="-1"></a>  Umat.isopod[<span class="fu">row</span>(Umat.isopod) <span class="sc">==</span> <span class="fu">col</span>(Umat.isopod)] <span class="ot">&lt;-</span> PV</span>
<span id="cb119-5"><a href="s09-Solutions.html#cb119-5" aria-hidden="true" tabindex="-1"></a>  Fmat.isopod[<span class="dv">1</span>,] <span class="ot">&lt;-</span> FV</span>
<span id="cb119-6"><a href="s09-Solutions.html#cb119-6" aria-hidden="true" tabindex="-1"></a>  Amat.isopod <span class="ot">&lt;-</span> Umat.isopod <span class="sc">+</span> Fmat.isopod</span>
<span id="cb119-7"><a href="s09-Solutions.html#cb119-7" aria-hidden="true" tabindex="-1"></a>  Amat.isopod</span>
<span id="cb119-8"><a href="s09-Solutions.html#cb119-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br></p>
<p>What happens to <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(\mathbf{u}\)</span> and <span class="math inline">\(\mathbf{v}\)</span> if you modify
the element <span class="math inline">\(G_6\)</span> (here the element is multiplied by 0.5):</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="s09-Solutions.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Modify element 6 of the G-vector, e.g. multiply it by 0.5</span></span>
<span id="cb120-2"><a href="s09-Solutions.html#cb120-2" aria-hidden="true" tabindex="-1"></a>Amat.isopod2 <span class="ot">&lt;-</span> <span class="fu">A.isopod</span>(<span class="at">GV=</span><span class="fu">c</span>(<span class="fl">0.722</span>, </span>
<span id="cb120-3"><a href="s09-Solutions.html#cb120-3" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.244</span>, </span>
<span id="cb120-4"><a href="s09-Solutions.html#cb120-4" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.231</span>, </span>
<span id="cb120-5"><a href="s09-Solutions.html#cb120-5" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.788</span>, </span>
<span id="cb120-6"><a href="s09-Solutions.html#cb120-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.792</span>, </span>
<span id="cb120-7"><a href="s09-Solutions.html#cb120-7" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.664</span>,</span>
<span id="cb120-8"><a href="s09-Solutions.html#cb120-8" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">0</span>))</span>
<span id="cb120-9"><a href="s09-Solutions.html#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="s09-Solutions.html#cb120-10" aria-hidden="true" tabindex="-1"></a>res.isopod2 <span class="ot">&lt;-</span> <span class="fu">uvlambda</span>(Amat.isopod2)</span>
<span id="cb120-11"><a href="s09-Solutions.html#cb120-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-12"><a href="s09-Solutions.html#cb120-12" aria-hidden="true" tabindex="-1"></a>lambda.isopod2 <span class="ot">&lt;-</span> res.isopod2<span class="sc">$</span>lam</span>
<span id="cb120-13"><a href="s09-Solutions.html#cb120-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-14"><a href="s09-Solutions.html#cb120-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Make a data frame for plotting:</span></span>
<span id="cb120-15"><a href="s09-Solutions.html#cb120-15" aria-hidden="true" tabindex="-1"></a>resframe.isopod2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Stage&quot;</span><span class="ot">=</span><span class="fu">as.factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), </span>
<span id="cb120-16"><a href="s09-Solutions.html#cb120-16" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;u&quot;</span><span class="ot">=</span>res.isopod2<span class="sc">$</span>u, </span>
<span id="cb120-17"><a href="s09-Solutions.html#cb120-17" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;v&quot;</span><span class="ot">=</span><span class="fu">as.vector</span>(res.isopod2<span class="sc">$</span>v))</span>
<span id="cb120-18"><a href="s09-Solutions.html#cb120-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-19"><a href="s09-Solutions.html#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format:</span></span>
<span id="cb120-20"><a href="s09-Solutions.html#cb120-20" aria-hidden="true" tabindex="-1"></a>resframe.isopod.long2 <span class="ot">&lt;-</span> resframe.isopod2 <span class="sc">%&gt;%</span> </span>
<span id="cb120-21"><a href="s09-Solutions.html#cb120-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(u, v), <span class="at">names_to =</span> <span class="st">&quot;uv&quot;</span>,</span>
<span id="cb120-22"><a href="s09-Solutions.html#cb120-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb120-23"><a href="s09-Solutions.html#cb120-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb120-24"><a href="s09-Solutions.html#cb120-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot with ggplot:</span></span>
<span id="cb120-25"><a href="s09-Solutions.html#cb120-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resframe.isopod.long2) <span class="sc">+</span> </span>
<span id="cb120-26"><a href="s09-Solutions.html#cb120-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>Stage, <span class="at">y=</span>Value, <span class="at">fill=</span>uv ))<span class="sc">+</span></span>
<span id="cb120-27"><a href="s09-Solutions.html#cb120-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors2)<span class="sc">+</span></span>
<span id="cb120-28"><a href="s09-Solutions.html#cb120-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(uv, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;u&quot;</span>, <span class="st">&quot;v&quot;</span>)), </span>
<span id="cb120-29"><a href="s09-Solutions.html#cb120-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb120-30"><a href="s09-Solutions.html#cb120-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb120-31"><a href="s09-Solutions.html#cb120-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Stage&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>)<span class="sc">+</span></span>
<span id="cb120-32"><a href="s09-Solutions.html#cb120-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-78-1.png" width="576" /></p>
<p><br></p>
<p>If we use a new value of <span class="math inline">\(G_6=0.5\cdot 0.664\)</span> (half the original), we get <span class="math inline">\(\lambda\approx\)</span> 1.0745, exactly the same as before. This is because only the final stage is affected, which is a post-reproductive stage not contributing to population growth. The stable structure changes slightly because we get relatively fewer individuals in the final stage. As a result the reproductive values are also rescaled but otherwise not changed.</p>
<p><br></p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<p>Modify the element <span class="math inline">\(G_4\)</span> instead:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="s09-Solutions.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Modify element 6 of the G-vector, e.g. multiply it by 0.5</span></span>
<span id="cb121-2"><a href="s09-Solutions.html#cb121-2" aria-hidden="true" tabindex="-1"></a>Amat.isopod3 <span class="ot">&lt;-</span> <span class="fu">A.isopod</span>(<span class="at">GV=</span><span class="fu">c</span>(<span class="fl">0.722</span>, </span>
<span id="cb121-3"><a href="s09-Solutions.html#cb121-3" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.244</span>, </span>
<span id="cb121-4"><a href="s09-Solutions.html#cb121-4" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.231</span>,</span>
<span id="cb121-5"><a href="s09-Solutions.html#cb121-5" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.788</span> , </span>
<span id="cb121-6"><a href="s09-Solutions.html#cb121-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.792</span>,</span>
<span id="cb121-7"><a href="s09-Solutions.html#cb121-7" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.664</span>,</span>
<span id="cb121-8"><a href="s09-Solutions.html#cb121-8" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">0</span>))</span>
<span id="cb121-9"><a href="s09-Solutions.html#cb121-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-10"><a href="s09-Solutions.html#cb121-10" aria-hidden="true" tabindex="-1"></a>res.isopod3 <span class="ot">&lt;-</span> <span class="fu">uvlambda</span>(Amat.isopod3)</span>
<span id="cb121-11"><a href="s09-Solutions.html#cb121-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-12"><a href="s09-Solutions.html#cb121-12" aria-hidden="true" tabindex="-1"></a>lambda.isopod3 <span class="ot">&lt;-</span> res.isopod3<span class="sc">$</span>lam</span>
<span id="cb121-13"><a href="s09-Solutions.html#cb121-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-14"><a href="s09-Solutions.html#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Make a data frame for plotting:</span></span>
<span id="cb121-15"><a href="s09-Solutions.html#cb121-15" aria-hidden="true" tabindex="-1"></a>resframe.isopod3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Stage&quot;</span><span class="ot">=</span><span class="fu">as.factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb121-16"><a href="s09-Solutions.html#cb121-16" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;u&quot;</span><span class="ot">=</span>res.isopod3<span class="sc">$</span>u, </span>
<span id="cb121-17"><a href="s09-Solutions.html#cb121-17" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;v&quot;</span><span class="ot">=</span><span class="fu">as.vector</span>(res.isopod3<span class="sc">$</span>v))</span>
<span id="cb121-18"><a href="s09-Solutions.html#cb121-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-19"><a href="s09-Solutions.html#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format:</span></span>
<span id="cb121-20"><a href="s09-Solutions.html#cb121-20" aria-hidden="true" tabindex="-1"></a>resframe.isopod.long3 <span class="ot">&lt;-</span> resframe.isopod3 <span class="sc">%&gt;%</span> </span>
<span id="cb121-21"><a href="s09-Solutions.html#cb121-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(u, v), </span>
<span id="cb121-22"><a href="s09-Solutions.html#cb121-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;uv&quot;</span>, </span>
<span id="cb121-23"><a href="s09-Solutions.html#cb121-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb121-24"><a href="s09-Solutions.html#cb121-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb121-25"><a href="s09-Solutions.html#cb121-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-26"><a href="s09-Solutions.html#cb121-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot with ggplot:</span></span>
<span id="cb121-27"><a href="s09-Solutions.html#cb121-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resframe.isopod.long3) <span class="sc">+</span> </span>
<span id="cb121-28"><a href="s09-Solutions.html#cb121-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>Stage, <span class="at">y=</span>Value, <span class="at">fill=</span>uv ))<span class="sc">+</span></span>
<span id="cb121-29"><a href="s09-Solutions.html#cb121-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors2)<span class="sc">+</span></span>
<span id="cb121-30"><a href="s09-Solutions.html#cb121-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(uv, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;u&quot;</span>, <span class="st">&quot;v&quot;</span>)), </span>
<span id="cb121-31"><a href="s09-Solutions.html#cb121-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb121-32"><a href="s09-Solutions.html#cb121-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb121-33"><a href="s09-Solutions.html#cb121-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Stage&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>)<span class="sc">+</span></span>
<span id="cb121-34"><a href="s09-Solutions.html#cb121-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-79-1.png" width="576" /></p>
<p><br></p>
<p>If we use a new value of <span class="math inline">\(G_4=0.5\cdot 0.788\)</span> (half the original), we get <span class="math inline">\(\lambda\approx\)</span> 1.0246, lower than before. This time the second reproductive stage is also affected, as fewer individuals transition out from stage 4. The highest reproductive value shifts to stage 6 instead of 4, but there are fewer individuals reaching this stage than before.</p>
<p><br></p>
</div>
<div id="exercise-4.3-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 4.3<a href="s09-Solutions.html#exercise-4.3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>To define the new matrix <span class="math inline">\(\mathbf{A}_C\)</span> we can use the function defined in exercise 4.2 returning the projection matrix as a function of the vectors <span class="math inline">\(P\)</span>, <span class="math inline">\(G\)</span>, and <span class="math inline">\(F\)</span>:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="s09-Solutions.html#cb122-1" aria-hidden="true" tabindex="-1"></a>PvecC <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.158</span>, <span class="fl">0.507</span>, <span class="fl">0.501</span>, <span class="fl">0.15</span>, <span class="fl">0.007</span>, <span class="fl">0.126</span>, <span class="fl">0.744</span>)</span>
<span id="cb122-2"><a href="s09-Solutions.html#cb122-2" aria-hidden="true" tabindex="-1"></a>GvecC <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.722</span>, <span class="fl">0.228</span>, <span class="fl">0.215</span>, <span class="fl">0.733</span>, <span class="fl">0.737</span>, <span class="fl">0.618</span>,<span class="dv">0</span>)</span>
<span id="cb122-3"><a href="s09-Solutions.html#cb122-3" aria-hidden="true" tabindex="-1"></a>FvecC <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.355</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb122-4"><a href="s09-Solutions.html#cb122-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb122-5"><a href="s09-Solutions.html#cb122-5" aria-hidden="true" tabindex="-1"></a>Amat.isopod.C <span class="ot">&lt;-</span> <span class="fu">A.isopod</span>(<span class="at">PV=</span>PvecC, <span class="at">GV=</span>GvecC, <span class="at">FV=</span>FvecC)</span></code></pre></div>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Calculate <span class="math inline">\(\lambda\)</span> for the new matrix:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="s09-Solutions.html#cb123-1" aria-hidden="true" tabindex="-1"></a>res.isopod.C <span class="ot">&lt;-</span> <span class="fu">uvlambda</span>(Amat.isopod.C)</span>
<span id="cb123-2"><a href="s09-Solutions.html#cb123-2" aria-hidden="true" tabindex="-1"></a>lambda.isopod.C <span class="ot">&lt;-</span> res.isopod.C<span class="sc">$</span>lam</span></code></pre></div>
<p>The value of <span class="math inline">\(\lambda\)</span> in the ‘cadmium environment’ is <span class="math inline">\(\lambda\approx\)</span> 0.8941, much lower than the reference values of <span class="math inline">\(\lambda_R\approx\)</span> 1.0745 (exercise 4.2). The difference in <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\lambda_C-\lambda_R\approx round(lambda.isopod.C-lambda.isopod,4)\)</span>.</p>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Calculate halfway and difference matrix:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="s09-Solutions.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Amat.isopod from previous exercise.</span></span>
<span id="cb124-2"><a href="s09-Solutions.html#cb124-2" aria-hidden="true" tabindex="-1"></a>Halfway.matrix.isopod <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>(Amat.isopod.C<span class="sc">+</span>Amat.isopod)</span>
<span id="cb124-3"><a href="s09-Solutions.html#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="s09-Solutions.html#cb124-4" aria-hidden="true" tabindex="-1"></a>Difference.matrix.isopod <span class="ot">&lt;-</span> (Amat.isopod.C<span class="sc">-</span>Amat.isopod)</span></code></pre></div>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>Calculate sensitivity matrix and calculate / plot LTRE contributions:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="s09-Solutions.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Modify element 6 of the G-vector, e.g. multiply it by 0.5</span></span>
<span id="cb125-2"><a href="s09-Solutions.html#cb125-2" aria-hidden="true" tabindex="-1"></a>Sensitivity.Halfway.isopod <span class="ot">&lt;-</span> </span>
<span id="cb125-3"><a href="s09-Solutions.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sensitivity.matrix</span>(Halfway.matrix.isopod)</span>
<span id="cb125-4"><a href="s09-Solutions.html#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="s09-Solutions.html#cb125-5" aria-hidden="true" tabindex="-1"></a>LTRE.matrix.isopod <span class="ot">&lt;-</span> <span class="fu">sensitivity.matrix</span>(Halfway.matrix.isopod)<span class="sc">*</span></span>
<span id="cb125-6"><a href="s09-Solutions.html#cb125-6" aria-hidden="true" tabindex="-1"></a>  Difference.matrix.isopod</span>
<span id="cb125-7"><a href="s09-Solutions.html#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="s09-Solutions.html#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract components corresponding to G, P, and F across stages:</span></span>
<span id="cb125-9"><a href="s09-Solutions.html#cb125-9" aria-hidden="true" tabindex="-1"></a>LTRE_F <span class="ot">&lt;-</span> LTRE.matrix.isopod[<span class="dv">1</span>,] </span>
<span id="cb125-10"><a href="s09-Solutions.html#cb125-10" aria-hidden="true" tabindex="-1"></a>LTRE_P <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">diag</span>(LTRE.matrix.isopod[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]),<span class="dv">0</span>)</span>
<span id="cb125-11"><a href="s09-Solutions.html#cb125-11" aria-hidden="true" tabindex="-1"></a>LTRE_G <span class="ot">&lt;-</span> <span class="fu">diag</span>(LTRE.matrix.isopod)</span>
<span id="cb125-12"><a href="s09-Solutions.html#cb125-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-13"><a href="s09-Solutions.html#cb125-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-14"><a href="s09-Solutions.html#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Make a data frame for plotting:</span></span>
<span id="cb125-15"><a href="s09-Solutions.html#cb125-15" aria-hidden="true" tabindex="-1"></a>LTREframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Stage&quot;</span><span class="ot">=</span><span class="fu">as.factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb125-16"><a href="s09-Solutions.html#cb125-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Gcont&quot;</span><span class="ot">=</span>LTRE_G,</span>
<span id="cb125-17"><a href="s09-Solutions.html#cb125-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Pcont&quot;</span><span class="ot">=</span>LTRE_P, </span>
<span id="cb125-18"><a href="s09-Solutions.html#cb125-18" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Fcont&quot;</span><span class="ot">=</span>LTRE_F)</span>
<span id="cb125-19"><a href="s09-Solutions.html#cb125-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-20"><a href="s09-Solutions.html#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format:</span></span>
<span id="cb125-21"><a href="s09-Solutions.html#cb125-21" aria-hidden="true" tabindex="-1"></a>LTREframe.long <span class="ot">&lt;-</span> LTREframe <span class="sc">%&gt;%</span> </span>
<span id="cb125-22"><a href="s09-Solutions.html#cb125-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(Gcont, Pcont, Fcont), </span>
<span id="cb125-23"><a href="s09-Solutions.html#cb125-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Contribution&quot;</span>, </span>
<span id="cb125-24"><a href="s09-Solutions.html#cb125-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb125-25"><a href="s09-Solutions.html#cb125-25" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb125-26"><a href="s09-Solutions.html#cb125-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-27"><a href="s09-Solutions.html#cb125-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot with ggplot:</span></span>
<span id="cb125-28"><a href="s09-Solutions.html#cb125-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(LTREframe.long) <span class="sc">+</span> </span>
<span id="cb125-29"><a href="s09-Solutions.html#cb125-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>Stage, <span class="at">y=</span>Value, </span>
<span id="cb125-30"><a href="s09-Solutions.html#cb125-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span>Contribution ))<span class="sc">+</span></span>
<span id="cb125-31"><a href="s09-Solutions.html#cb125-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors3)<span class="sc">+</span></span>
<span id="cb125-32"><a href="s09-Solutions.html#cb125-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(Contribution, </span>
<span id="cb125-33"><a href="s09-Solutions.html#cb125-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Gcont&quot;</span>, <span class="st">&quot;Pcont&quot;</span>, <span class="st">&quot;Fcont&quot;</span>)), </span>
<span id="cb125-34"><a href="s09-Solutions.html#cb125-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb125-35"><a href="s09-Solutions.html#cb125-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb125-36"><a href="s09-Solutions.html#cb125-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Stage&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>)<span class="sc">+</span></span>
<span id="cb125-37"><a href="s09-Solutions.html#cb125-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-83-1.png" width="864" /></p>
<p><br></p>
<p>The contributions to <span class="math inline">\(\lambda_C-\lambda_R\approx\)</span> -0.1804 are highest from <span class="math inline">\(P\)</span> and <span class="math inline">\(G\)</span> of stage 2 and 3, and from fertility of stage 6. The sum of contributions is <span class="math inline">\(\sum_{i,j}D_{ij}S^*_{ij}\approx\)</span> -0.1687, a bit lower than the actual difference.</p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<p>LTRE is better if we want to understand the difference in <span class="math inline">\(\lambda\)</span> in two different environments (or here, treatments), more specifically which parts of the projection matrix contribute to this difference. A sensitivity analysis applies to one environment and tells us how <span class="math inline">\(\lambda\)</span> would respond to small perturbations in each matrix element. The sensitivity analysis is prospective, while the LTRE analysis is retrospective <span class="citation">(<a href="#ref-Caswell1" role="doc-biblioref">Hal Caswell 2001</a>)</span>.</p>
<p><br><br></p>
</div>
</div>
<div id="chapter-5-exercises" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">A.5</span> Chapter 5 exercises<a href="s09-Solutions.html#chapter-5-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><br></p>
<div id="exercise-5.1-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 5.1<a href="s09-Solutions.html#exercise-5.1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><br></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>Add stochasticity to the fecundity coefficients, make plots:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="s09-Solutions.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Project growth, variance 0.1</span></span>
<span id="cb126-2"><a href="s09-Solutions.html#cb126-2" aria-hidden="true" tabindex="-1"></a>stochastic.plant <span class="ot">&lt;-</span> <span class="fu">projection.stochastic</span>(</span>
<span id="cb126-3"><a href="s09-Solutions.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amats =</span> <span class="fu">Amat.array</span>(<span class="at">MatA=</span>APlant, </span>
<span id="cb126-4"><a href="s09-Solutions.html#cb126-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">MatU=</span>UPlant, </span>
<span id="cb126-5"><a href="s09-Solutions.html#cb126-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">MatF=</span>FPlant, </span>
<span id="cb126-6"><a href="s09-Solutions.html#cb126-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">tmax=</span><span class="dv">30</span>, </span>
<span id="cb126-7"><a href="s09-Solutions.html#cb126-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">VarF=</span><span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="dv">4</span>),</span>
<span id="cb126-8"><a href="s09-Solutions.html#cb126-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">VarS=</span><span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)), </span>
<span id="cb126-9"><a href="s09-Solutions.html#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">n0=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">4</span>)))</span>
<span id="cb126-10"><a href="s09-Solutions.html#cb126-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-11"><a href="s09-Solutions.html#cb126-11" aria-hidden="true" tabindex="-1"></a>stochastic.plant<span class="sc">$</span>varF <span class="ot">&lt;-</span>  <span class="st">&quot;0.1&quot;</span></span>
<span id="cb126-12"><a href="s09-Solutions.html#cb126-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-13"><a href="s09-Solutions.html#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Project growth, variance 0.01</span></span>
<span id="cb126-14"><a href="s09-Solutions.html#cb126-14" aria-hidden="true" tabindex="-1"></a>stochastic.plant2 <span class="ot">&lt;-</span> <span class="fu">projection.stochastic</span>(</span>
<span id="cb126-15"><a href="s09-Solutions.html#cb126-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amats =</span> <span class="fu">Amat.array</span>(<span class="at">MatA=</span>APlant, </span>
<span id="cb126-16"><a href="s09-Solutions.html#cb126-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">MatU=</span>UPlant, </span>
<span id="cb126-17"><a href="s09-Solutions.html#cb126-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">MatF=</span>FPlant, </span>
<span id="cb126-18"><a href="s09-Solutions.html#cb126-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">tmax=</span><span class="dv">30</span>, </span>
<span id="cb126-19"><a href="s09-Solutions.html#cb126-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">VarF=</span><span class="fu">rep</span>(<span class="fl">0.01</span>, <span class="dv">4</span>), </span>
<span id="cb126-20"><a href="s09-Solutions.html#cb126-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">VarS=</span><span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)), </span>
<span id="cb126-21"><a href="s09-Solutions.html#cb126-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">n0=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">4</span>)))</span>
<span id="cb126-22"><a href="s09-Solutions.html#cb126-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-23"><a href="s09-Solutions.html#cb126-23" aria-hidden="true" tabindex="-1"></a>stochastic.plant2<span class="sc">$</span>varF <span class="ot">&lt;-</span>  <span class="st">&quot;0.01&quot;</span></span>
<span id="cb126-24"><a href="s09-Solutions.html#cb126-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-25"><a href="s09-Solutions.html#cb126-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-26"><a href="s09-Solutions.html#cb126-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Add the two:</span></span>
<span id="cb126-27"><a href="s09-Solutions.html#cb126-27" aria-hidden="true" tabindex="-1"></a>stochastic.plant <span class="ot">&lt;-</span> <span class="fu">rbind</span>(stochastic.plant, stochastic.plant2) </span>
<span id="cb126-28"><a href="s09-Solutions.html#cb126-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-29"><a href="s09-Solutions.html#cb126-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-30"><a href="s09-Solutions.html#cb126-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format for plotting:</span></span>
<span id="cb126-31"><a href="s09-Solutions.html#cb126-31" aria-hidden="true" tabindex="-1"></a>stochastic.plant.long <span class="ot">&lt;-</span> stochastic.plant <span class="sc">%&gt;%</span> </span>
<span id="cb126-32"><a href="s09-Solutions.html#cb126-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="sc">-</span>time,<span class="sc">-</span>varF), <span class="at">names_to =</span> <span class="st">&quot;AgeClass&quot;</span>, </span>
<span id="cb126-33"><a href="s09-Solutions.html#cb126-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb126-34"><a href="s09-Solutions.html#cb126-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-35"><a href="s09-Solutions.html#cb126-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot:</span></span>
<span id="cb126-36"><a href="s09-Solutions.html#cb126-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stochastic.plant.long) <span class="sc">+</span> </span>
<span id="cb126-37"><a href="s09-Solutions.html#cb126-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>time,  <span class="at">y=</span>Value, </span>
<span id="cb126-38"><a href="s09-Solutions.html#cb126-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">col=</span>AgeClass, <span class="at">linetype=</span>AgeClass), <span class="at">lwd=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb126-39"><a href="s09-Solutions.html#cb126-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>Value, </span>
<span id="cb126-40"><a href="s09-Solutions.html#cb126-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col=</span>AgeClass), <span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb126-41"><a href="s09-Solutions.html#cb126-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb126-42"><a href="s09-Solutions.html#cb126-42" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(varF, </span>
<span id="cb126-43"><a href="s09-Solutions.html#cb126-43" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;0.1&quot;</span>, <span class="st">&quot;0.01&quot;</span>)))<span class="sc">+</span></span>
<span id="cb126-44"><a href="s09-Solutions.html#cb126-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>colors4)<span class="sc">+</span> </span>
<span id="cb126-45"><a href="s09-Solutions.html#cb126-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">+</span>  </span>
<span id="cb126-46"><a href="s09-Solutions.html#cb126-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Time (year)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Age class size&quot;</span>)  <span class="sc">+</span></span>
<span id="cb126-47"><a href="s09-Solutions.html#cb126-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-85-1.png" width="576" /></p>
<p><br></p>
<p>Variance in fertility increases the fluctuations in particular of the first age class. Note that we still have transient fluctuations in the beginning on top of the stochastic fluctuations. In the second case with lower variance in fertility, the variance in stage structure stabilizes at a lower value as well.</p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Add stochasticity to the survival coefficients instead:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="s09-Solutions.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Project growth, variance 0.1</span></span>
<span id="cb127-2"><a href="s09-Solutions.html#cb127-2" aria-hidden="true" tabindex="-1"></a>stochastic.plant <span class="ot">&lt;-</span> <span class="fu">projection.stochastic</span>(</span>
<span id="cb127-3"><a href="s09-Solutions.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amats =</span> <span class="fu">Amat.array</span>(<span class="at">MatA=</span>APlant, </span>
<span id="cb127-4"><a href="s09-Solutions.html#cb127-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">MatU=</span>UPlant, </span>
<span id="cb127-5"><a href="s09-Solutions.html#cb127-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">MatF=</span>FPlant, </span>
<span id="cb127-6"><a href="s09-Solutions.html#cb127-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">tmax=</span><span class="dv">30</span>, </span>
<span id="cb127-7"><a href="s09-Solutions.html#cb127-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">VarF=</span><span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), </span>
<span id="cb127-8"><a href="s09-Solutions.html#cb127-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">VarS=</span><span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="dv">4</span>)), </span>
<span id="cb127-9"><a href="s09-Solutions.html#cb127-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">n0=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">4</span>)))</span>
<span id="cb127-10"><a href="s09-Solutions.html#cb127-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-11"><a href="s09-Solutions.html#cb127-11" aria-hidden="true" tabindex="-1"></a>stochastic.plant<span class="sc">$</span>varS <span class="ot">&lt;-</span>  <span class="st">&quot;0.1&quot;</span></span>
<span id="cb127-12"><a href="s09-Solutions.html#cb127-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-13"><a href="s09-Solutions.html#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Project growth, variance 0.01</span></span>
<span id="cb127-14"><a href="s09-Solutions.html#cb127-14" aria-hidden="true" tabindex="-1"></a>stochastic.plant2 <span class="ot">&lt;-</span> <span class="fu">projection.stochastic</span>(</span>
<span id="cb127-15"><a href="s09-Solutions.html#cb127-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amats =</span> <span class="fu">Amat.array</span>(<span class="at">MatA=</span>APlant, </span>
<span id="cb127-16"><a href="s09-Solutions.html#cb127-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">MatU=</span>UPlant, </span>
<span id="cb127-17"><a href="s09-Solutions.html#cb127-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">MatF=</span>FPlant, </span>
<span id="cb127-18"><a href="s09-Solutions.html#cb127-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">tmax=</span><span class="dv">30</span>, </span>
<span id="cb127-19"><a href="s09-Solutions.html#cb127-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">VarF=</span><span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), </span>
<span id="cb127-20"><a href="s09-Solutions.html#cb127-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">VarS=</span><span class="fu">rep</span>(<span class="fl">0.01</span>, <span class="dv">4</span>)), </span>
<span id="cb127-21"><a href="s09-Solutions.html#cb127-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">n0=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">4</span>)))</span>
<span id="cb127-22"><a href="s09-Solutions.html#cb127-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-23"><a href="s09-Solutions.html#cb127-23" aria-hidden="true" tabindex="-1"></a>stochastic.plant2<span class="sc">$</span>varS <span class="ot">&lt;-</span>  <span class="st">&quot;0.01&quot;</span></span>
<span id="cb127-24"><a href="s09-Solutions.html#cb127-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-25"><a href="s09-Solutions.html#cb127-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-26"><a href="s09-Solutions.html#cb127-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Add the two:</span></span>
<span id="cb127-27"><a href="s09-Solutions.html#cb127-27" aria-hidden="true" tabindex="-1"></a>stochastic.plant <span class="ot">&lt;-</span> <span class="fu">rbind</span>(stochastic.plant, </span>
<span id="cb127-28"><a href="s09-Solutions.html#cb127-28" aria-hidden="true" tabindex="-1"></a>                          stochastic.plant2) </span>
<span id="cb127-29"><a href="s09-Solutions.html#cb127-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-30"><a href="s09-Solutions.html#cb127-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-31"><a href="s09-Solutions.html#cb127-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Long format for plotting:</span></span>
<span id="cb127-32"><a href="s09-Solutions.html#cb127-32" aria-hidden="true" tabindex="-1"></a>stochastic.plant.long <span class="ot">&lt;-</span> stochastic.plant <span class="sc">%&gt;%</span> </span>
<span id="cb127-33"><a href="s09-Solutions.html#cb127-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="sc">-</span>time,<span class="sc">-</span>varS),</span>
<span id="cb127-34"><a href="s09-Solutions.html#cb127-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;AgeClass&quot;</span>, </span>
<span id="cb127-35"><a href="s09-Solutions.html#cb127-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb127-36"><a href="s09-Solutions.html#cb127-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-37"><a href="s09-Solutions.html#cb127-37" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot:</span></span>
<span id="cb127-38"><a href="s09-Solutions.html#cb127-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stochastic.plant.long) <span class="sc">+</span> </span>
<span id="cb127-39"><a href="s09-Solutions.html#cb127-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>Value, <span class="at">col=</span>AgeClass, </span>
<span id="cb127-40"><a href="s09-Solutions.html#cb127-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype=</span>AgeClass), <span class="at">lwd=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb127-41"><a href="s09-Solutions.html#cb127-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>Value, <span class="at">col=</span>AgeClass), </span>
<span id="cb127-42"><a href="s09-Solutions.html#cb127-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb127-43"><a href="s09-Solutions.html#cb127-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb127-44"><a href="s09-Solutions.html#cb127-44" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(varS, </span>
<span id="cb127-45"><a href="s09-Solutions.html#cb127-45" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;0.1&quot;</span>, <span class="st">&quot;0.01&quot;</span>)))<span class="sc">+</span></span>
<span id="cb127-46"><a href="s09-Solutions.html#cb127-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>colors4)<span class="sc">+</span> </span>
<span id="cb127-47"><a href="s09-Solutions.html#cb127-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">+</span>  </span>
<span id="cb127-48"><a href="s09-Solutions.html#cb127-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Time (year)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Age class size&quot;</span>)  <span class="sc">+</span></span>
<span id="cb127-49"><a href="s09-Solutions.html#cb127-49" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span> ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-86-1.png" width="576" /></p>
<p><br></p>
<p>We get quite similar patterns with variance on survival coefficients instead of fertility. This is because any fluctuations in one age class are carried on to the next, and to offspring. We always get more variation in the offspring class, because this is the largest class.</p>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li>There are many potential ways a plant like this could show bet-hedging strategies, for instance:</li>
</ol>
<ul>
<li><p>Conservative bet-hedging (‘play it safe’): Reduce the mean fecundity to increase mean survival. This could mean that the plant might reduce annual variance in fitness, at the cost of not being able to maximize reproduction in good years.</p></li>
<li><p>Diversifying bet-hedging (‘don’t put all eggs in one basket’): Spreading the risk among offspring (here seeds), either through different phenotypes, different spatial habitats, or different hatching times. The latter can be achieved through a seed bank, where seeds can lay dormant for many years before germinating.</p></li>
</ul>
<p>A seed bank is a complicating factor to include in matrix models, but could be achieved by adding a new stage for the dormant seeds, with a certain probability of hatching each year. This would turn the model into a stage structured model.</p>
<p>One could argue that the plant life history already shows some bet-hedging since it reproduces at two ages, thus spreading the risk of reproducing at least among two years. Iteroparity can be interpreted as a bet-hedging strategy, but strictly speaking we would have to prove a cost to the arithmetic mean fitness to call it bet-hedging (e.g. lowering the maximum number of offspring that can be produced in good years).</p>
<p><br></p>
</div>
<div id="exercise-5.2-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 5.2<a href="s09-Solutions.html#exercise-5.2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>Calculate <span class="math inline">\(\lambda\)</span> for each habitat:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="s09-Solutions.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the Leslie matrices</span></span>
<span id="cb128-2"><a href="s09-Solutions.html#cb128-2" aria-hidden="true" tabindex="-1"></a>AmatPoor <span class="ot">&lt;-</span> <span class="fu">Create.Amat</span>(<span class="at">Svec=</span><span class="fu">c</span>(.<span class="dv">8</span>,<span class="fu">rep</span>(.<span class="dv">82</span>,<span class="dv">4</span>)),</span>
<span id="cb128-3"><a href="s09-Solutions.html#cb128-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Fvec=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.16</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>) )</span>
<span id="cb128-4"><a href="s09-Solutions.html#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="s09-Solutions.html#cb128-5" aria-hidden="true" tabindex="-1"></a>AmatGood <span class="ot">&lt;-</span> <span class="fu">Create.Amat</span>(<span class="at">Svec=</span><span class="fu">c</span>(.<span class="dv">8</span>,<span class="fu">rep</span>(.<span class="dv">82</span>,<span class="dv">4</span>)),</span>
<span id="cb128-6"><a href="s09-Solutions.html#cb128-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Fvec=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.096</span>, <span class="fl">0.16</span>, <span class="fl">0.224</span>, <span class="fl">0.32</span>)  )</span>
<span id="cb128-7"><a href="s09-Solutions.html#cb128-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-8"><a href="s09-Solutions.html#cb128-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-9"><a href="s09-Solutions.html#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate lambda:</span></span>
<span id="cb128-10"><a href="s09-Solutions.html#cb128-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-11"><a href="s09-Solutions.html#cb128-11" aria-hidden="true" tabindex="-1"></a>lambda.good <span class="ot">&lt;-</span> <span class="fu">uvlambda</span>(AmatGood)<span class="sc">$</span>lam</span>
<span id="cb128-12"><a href="s09-Solutions.html#cb128-12" aria-hidden="true" tabindex="-1"></a>lambda.poor <span class="ot">&lt;-</span> <span class="fu">uvlambda</span>(AmatPoor)<span class="sc">$</span>lam</span>
<span id="cb128-13"><a href="s09-Solutions.html#cb128-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-14"><a href="s09-Solutions.html#cb128-14" aria-hidden="true" tabindex="-1"></a>lambda.habitats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;lambda.good&quot;</span><span class="ot">=</span>lambda.good, <span class="st">&quot;lambda.poor&quot;</span><span class="ot">=</span>lambda.poor)</span>
<span id="cb128-15"><a href="s09-Solutions.html#cb128-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-16"><a href="s09-Solutions.html#cb128-16" aria-hidden="true" tabindex="-1"></a>lambda.habitats</span></code></pre></div>
<pre><code>##   lambda.good lambda.poor
## 1     1.01092   0.9682986</code></pre>
<p><br></p>
<p>We see that <span class="math inline">\(\lambda&gt;1\)</span> in the good habitat, and <span class="math inline">\(\lambda&lt;1\)</span> in the poor habitat. This calculation assumes no connection between them, treating each as a separate population (what would hypothetically happen to each over time with no migration between them).</p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Generate sequence of matrices returned as array:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="s09-Solutions.html#cb130-1" aria-hidden="true" tabindex="-1"></a>ArrayFunction <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">Agood=</span>AmatGood, </span>
<span id="cb130-2"><a href="s09-Solutions.html#cb130-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Apoor=</span>AmatPoor, </span>
<span id="cb130-3"><a href="s09-Solutions.html#cb130-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">time=</span><span class="dv">30</span>){</span>
<span id="cb130-4"><a href="s09-Solutions.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Generate sequence of good or bad habitat years:</span></span>
<span id="cb130-5"><a href="s09-Solutions.html#cb130-5" aria-hidden="true" tabindex="-1"></a>  random.sequence <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Poor&quot;</span>), </span>
<span id="cb130-6"><a href="s09-Solutions.html#cb130-6" aria-hidden="true" tabindex="-1"></a>                            time, </span>
<span id="cb130-7"><a href="s09-Solutions.html#cb130-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-8"><a href="s09-Solutions.html#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Generate empty array:</span></span>
<span id="cb130-9"><a href="s09-Solutions.html#cb130-9" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">dim</span>(Agood)[<span class="dv">1</span>]</span>
<span id="cb130-10"><a href="s09-Solutions.html#cb130-10" aria-hidden="true" tabindex="-1"></a>  A.array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(k,k,time))</span>
<span id="cb130-11"><a href="s09-Solutions.html#cb130-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Fill in right matrix depending on the sequence</span></span>
<span id="cb130-12"><a href="s09-Solutions.html#cb130-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>time){</span>
<span id="cb130-13"><a href="s09-Solutions.html#cb130-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(random.sequence[i]<span class="sc">==</span><span class="st">&quot;Good&quot;</span>){</span>
<span id="cb130-14"><a href="s09-Solutions.html#cb130-14" aria-hidden="true" tabindex="-1"></a>      A.array[,,i] <span class="ot">&lt;-</span> Agood</span>
<span id="cb130-15"><a href="s09-Solutions.html#cb130-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb130-16"><a href="s09-Solutions.html#cb130-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb130-17"><a href="s09-Solutions.html#cb130-17" aria-hidden="true" tabindex="-1"></a>       A.array[,,i] <span class="ot">&lt;-</span> Apoor</span>
<span id="cb130-18"><a href="s09-Solutions.html#cb130-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb130-19"><a href="s09-Solutions.html#cb130-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb130-20"><a href="s09-Solutions.html#cb130-20" aria-hidden="true" tabindex="-1"></a>  A.array</span>
<span id="cb130-21"><a href="s09-Solutions.html#cb130-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-22"><a href="s09-Solutions.html#cb130-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-23"><a href="s09-Solutions.html#cb130-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Test:</span></span>
<span id="cb130-24"><a href="s09-Solutions.html#cb130-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ArrayFunction</span>(<span class="at">time=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## , , 1
## 
##      [,1]  [,2] [,3]  [,4] [,5]
## [1,]  0.0 0.096 0.16 0.224 0.32
## [2,]  0.8 0.000 0.00 0.000 0.00
## [3,]  0.0 0.820 0.00 0.000 0.00
## [4,]  0.0 0.000 0.82 0.000 0.00
## [5,]  0.0 0.000 0.00 0.820 0.82
## 
## , , 2
## 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]  0.0 0.10 0.16 0.20 0.20
## [2,]  0.8 0.00 0.00 0.00 0.00
## [3,]  0.0 0.82 0.00 0.00 0.00
## [4,]  0.0 0.00 0.82 0.00 0.00
## [5,]  0.0 0.00 0.00 0.82 0.82
## 
## , , 3
## 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]  0.0 0.10 0.16 0.20 0.20
## [2,]  0.8 0.00 0.00 0.00 0.00
## [3,]  0.0 0.82 0.00 0.00 0.00
## [4,]  0.0 0.00 0.82 0.00 0.00
## [5,]  0.0 0.00 0.00 0.82 0.82</code></pre>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>The mean growth rate corresponds (in this case) to the growth rate <span class="math inline">\(\lambda_m\)</span> of the mean matrix:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="s09-Solutions.html#cb132-1" aria-hidden="true" tabindex="-1"></a>MeanMatrix <span class="ot">&lt;-</span> (AmatPoor<span class="sc">+</span>AmatGood)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb132-2"><a href="s09-Solutions.html#cb132-2" aria-hidden="true" tabindex="-1"></a>r.mean <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">uvlambda</span>(MeanMatrix)<span class="sc">$</span>lambda)</span></code></pre></div>
<p><br></p>
<p>Stochastic growth rate:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="s09-Solutions.html#cb133-1" aria-hidden="true" tabindex="-1"></a>AMATS<span class="ot">&lt;-</span><span class="fu">ArrayFunction</span>(<span class="at">time=</span><span class="dv">10000</span>)</span>
<span id="cb133-2"><a href="s09-Solutions.html#cb133-2" aria-hidden="true" tabindex="-1"></a>rs.gull <span class="ot">&lt;-</span> <span class="fu">EstimateSGR</span>(<span class="at">Amats =</span> AMATS, <span class="at">n0=</span><span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span></code></pre></div>
<p><br></p>
<p>For the gulls the mean growth rate is <span class="math inline">\(r\approx\)</span> -0.0089, while the stochastic growth rate is <span class="math inline">\(r_s\approx\)</span> -0.0092. Both are negative, the stochastic growth rate sligtly lower.</p>
<p>To make a quantile plot we perform a large number of stochastic simulations as described in the chapter and shown for the songbird example, after modifying the <code>nsim.stochastic</code> function to include the new random process of generating an array of matrices:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="s09-Solutions.html#cb134-1" aria-hidden="true" tabindex="-1"></a>nsim.stochastic.gull <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">Agood=</span>AmatGood, </span>
<span id="cb134-2"><a href="s09-Solutions.html#cb134-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Apoor=</span>AmatPoor, </span>
<span id="cb134-3"><a href="s09-Solutions.html#cb134-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">tmax=</span><span class="dv">30</span>, </span>
<span id="cb134-4"><a href="s09-Solutions.html#cb134-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nsim=</span><span class="dv">1000</span>,</span>
<span id="cb134-5"><a href="s09-Solutions.html#cb134-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n0=</span><span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">5</span>)){</span>
<span id="cb134-6"><a href="s09-Solutions.html#cb134-6" aria-hidden="true" tabindex="-1"></a>  frame <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="st">&quot;Time&quot;</span><span class="ot">=</span><span class="dv">0</span><span class="sc">:</span>tmax)</span>
<span id="cb134-7"><a href="s09-Solutions.html#cb134-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb134-8"><a href="s09-Solutions.html#cb134-8" aria-hidden="true" tabindex="-1"></a>    AMATS <span class="ot">&lt;-</span> <span class="fu">ArrayFunction</span>(<span class="at">Agood=</span>Agood, </span>
<span id="cb134-9"><a href="s09-Solutions.html#cb134-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Apoor=</span>Apoor,</span>
<span id="cb134-10"><a href="s09-Solutions.html#cb134-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">time=</span>tmax)</span>
<span id="cb134-11"><a href="s09-Solutions.html#cb134-11" aria-hidden="true" tabindex="-1"></a>    projectN <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">projection.stochastic</span>(</span>
<span id="cb134-12"><a href="s09-Solutions.html#cb134-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">Amats=</span>AMATS,  <span class="at">n0=</span>n0)[,<span class="sc">-</span><span class="dv">1</span>],<span class="dv">1</span>,sum)</span>
<span id="cb134-13"><a href="s09-Solutions.html#cb134-13" aria-hidden="true" tabindex="-1"></a>    frame <span class="ot">&lt;-</span> <span class="fu">cbind</span>(frame, projectN)</span>
<span id="cb134-14"><a href="s09-Solutions.html#cb134-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">names</span>(frame)[m<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Rep&quot;</span>,m,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb134-15"><a href="s09-Solutions.html#cb134-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb134-16"><a href="s09-Solutions.html#cb134-16" aria-hidden="true" tabindex="-1"></a>  frame</span>
<span id="cb134-17"><a href="s09-Solutions.html#cb134-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb134-18"><a href="s09-Solutions.html#cb134-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-19"><a href="s09-Solutions.html#cb134-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply function to get 10 0000 realizations (can take some time)</span></span>
<span id="cb134-20"><a href="s09-Solutions.html#cb134-20" aria-hidden="true" tabindex="-1"></a>simgull_Large <span class="ot">&lt;-</span> <span class="fu">nsim.stochastic.gull</span>(<span class="at">nsim=</span><span class="dv">10000</span>)</span>
<span id="cb134-21"><a href="s09-Solutions.html#cb134-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-22"><a href="s09-Solutions.html#cb134-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the 5, 25, 50, 75, and 95 percentiles:</span></span>
<span id="cb134-23"><a href="s09-Solutions.html#cb134-23" aria-hidden="true" tabindex="-1"></a>PercentilesGull  <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(<span class="fu">t</span>(simgull_Large[,<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb134-24"><a href="s09-Solutions.html#cb134-24" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span>, </span>
<span id="cb134-25"><a href="s09-Solutions.html#cb134-25" aria-hidden="true" tabindex="-1"></a>                            quantile, </span>
<span id="cb134-26"><a href="s09-Solutions.html#cb134-26" aria-hidden="true" tabindex="-1"></a>                            <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>,.<span class="dv">95</span>)))</span>
<span id="cb134-27"><a href="s09-Solutions.html#cb134-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-28"><a href="s09-Solutions.html#cb134-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb134-29"><a href="s09-Solutions.html#cb134-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Store percentiles in data frame  </span></span>
<span id="cb134-30"><a href="s09-Solutions.html#cb134-30" aria-hidden="true" tabindex="-1"></a>GullPercentiles <span class="ot">&lt;-</span> </span>
<span id="cb134-31"><a href="s09-Solutions.html#cb134-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Time&quot;</span><span class="ot">=</span><span class="dv">0</span><span class="sc">:</span>(<span class="fu">dim</span>(PercentilesGull)[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb134-32"><a href="s09-Solutions.html#cb134-32" aria-hidden="true" tabindex="-1"></a>                                       PercentilesGull))</span>
<span id="cb134-33"><a href="s09-Solutions.html#cb134-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-34"><a href="s09-Solutions.html#cb134-34" aria-hidden="true" tabindex="-1"></a>GullPercentiles<span class="sc">$</span>Mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">t</span>(simgull_Large[,<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb134-35"><a href="s09-Solutions.html#cb134-35" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">2</span>, </span>
<span id="cb134-36"><a href="s09-Solutions.html#cb134-36" aria-hidden="true" tabindex="-1"></a>                              mean)</span>
<span id="cb134-37"><a href="s09-Solutions.html#cb134-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-38"><a href="s09-Solutions.html#cb134-38" aria-hidden="true" tabindex="-1"></a><span class="co">#Make long format for plotting</span></span>
<span id="cb134-39"><a href="s09-Solutions.html#cb134-39" aria-hidden="true" tabindex="-1"></a>GullPercentiles.long <span class="ot">&lt;-</span> GullPercentiles <span class="sc">%&gt;%</span> </span>
<span id="cb134-40"><a href="s09-Solutions.html#cb134-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="sc">-</span>Time),</span>
<span id="cb134-41"><a href="s09-Solutions.html#cb134-41" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Percentile&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>)</span>
<span id="cb134-42"><a href="s09-Solutions.html#cb134-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-43"><a href="s09-Solutions.html#cb134-43" aria-hidden="true" tabindex="-1"></a><span class="co">#Make sure the order of the percentiles is correct</span></span>
<span id="cb134-44"><a href="s09-Solutions.html#cb134-44" aria-hidden="true" tabindex="-1"></a>GullPercentiles.long<span class="sc">$</span>Percentile <span class="ot">&lt;-</span> </span>
<span id="cb134-45"><a href="s09-Solutions.html#cb134-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(GullPercentiles.long<span class="sc">$</span>Percentile, </span>
<span id="cb134-46"><a href="s09-Solutions.html#cb134-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;5%&quot;</span>, <span class="st">&quot;25%&quot;</span>, <span class="st">&quot;50%&quot;</span>, <span class="st">&quot;75%&quot;</span>, <span class="st">&quot;95%&quot;</span>,<span class="st">&quot;Mean&quot;</span>))</span>
<span id="cb134-47"><a href="s09-Solutions.html#cb134-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-48"><a href="s09-Solutions.html#cb134-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(GullPercentiles.long) <span class="sc">+</span> </span>
<span id="cb134-49"><a href="s09-Solutions.html#cb134-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>N, <span class="at">col=</span>Percentile,</span>
<span id="cb134-50"><a href="s09-Solutions.html#cb134-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype=</span>Percentile), <span class="at">lwd=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb134-51"><a href="s09-Solutions.html#cb134-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(colors5,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb134-52"><a href="s09-Solutions.html#cb134-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb134-53"><a href="s09-Solutions.html#cb134-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb134-54"><a href="s09-Solutions.html#cb134-54" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb134-55"><a href="s09-Solutions.html#cb134-55" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb134-56"><a href="s09-Solutions.html#cb134-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Time (year)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Population size N&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-57"><a href="s09-Solutions.html#cb134-57" aria-hidden="true" tabindex="-1"></a>   <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="576" /></p>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>First we add the probability argument to the function generating a random sequence of projection matrices:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="s09-Solutions.html#cb135-1" aria-hidden="true" tabindex="-1"></a>ArrayFunction <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">Agood=</span>AmatGood, </span>
<span id="cb135-2"><a href="s09-Solutions.html#cb135-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Apoor=</span>AmatPoor,</span>
<span id="cb135-3"><a href="s09-Solutions.html#cb135-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">time=</span><span class="dv">30</span>, </span>
<span id="cb135-4"><a href="s09-Solutions.html#cb135-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prob=</span><span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>)){</span>
<span id="cb135-5"><a href="s09-Solutions.html#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Generate sequence of good or bad habitat years:</span></span>
<span id="cb135-6"><a href="s09-Solutions.html#cb135-6" aria-hidden="true" tabindex="-1"></a>  random.sequence <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Poor&quot;</span>), </span>
<span id="cb135-7"><a href="s09-Solutions.html#cb135-7" aria-hidden="true" tabindex="-1"></a>                            time,</span>
<span id="cb135-8"><a href="s09-Solutions.html#cb135-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">replace=</span><span class="cn">TRUE</span>,</span>
<span id="cb135-9"><a href="s09-Solutions.html#cb135-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">prob=</span>prob)</span>
<span id="cb135-10"><a href="s09-Solutions.html#cb135-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Generate empty array:</span></span>
<span id="cb135-11"><a href="s09-Solutions.html#cb135-11" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">dim</span>(Agood)[<span class="dv">1</span>]</span>
<span id="cb135-12"><a href="s09-Solutions.html#cb135-12" aria-hidden="true" tabindex="-1"></a>  A.array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(k,k,time))</span>
<span id="cb135-13"><a href="s09-Solutions.html#cb135-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Fill in right matrix depending on the sequence</span></span>
<span id="cb135-14"><a href="s09-Solutions.html#cb135-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>time){</span>
<span id="cb135-15"><a href="s09-Solutions.html#cb135-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(random.sequence[i]<span class="sc">==</span><span class="st">&quot;Good&quot;</span>){</span>
<span id="cb135-16"><a href="s09-Solutions.html#cb135-16" aria-hidden="true" tabindex="-1"></a>      A.array[,,i] <span class="ot">&lt;-</span> Agood</span>
<span id="cb135-17"><a href="s09-Solutions.html#cb135-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb135-18"><a href="s09-Solutions.html#cb135-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb135-19"><a href="s09-Solutions.html#cb135-19" aria-hidden="true" tabindex="-1"></a>       A.array[,,i] <span class="ot">&lt;-</span> Apoor</span>
<span id="cb135-20"><a href="s09-Solutions.html#cb135-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb135-21"><a href="s09-Solutions.html#cb135-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb135-22"><a href="s09-Solutions.html#cb135-22" aria-hidden="true" tabindex="-1"></a>  A.array</span>
<span id="cb135-23"><a href="s09-Solutions.html#cb135-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br></p>
<p>Then we modify the simulation function to include the argument</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="s09-Solutions.html#cb136-1" aria-hidden="true" tabindex="-1"></a>nsim.stochastic.gull <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">Agood=</span>AmatGood, </span>
<span id="cb136-2"><a href="s09-Solutions.html#cb136-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Apoor=</span>AmatPoor, </span>
<span id="cb136-3"><a href="s09-Solutions.html#cb136-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">tmax=</span><span class="dv">30</span>, </span>
<span id="cb136-4"><a href="s09-Solutions.html#cb136-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nsim=</span><span class="dv">1000</span>, </span>
<span id="cb136-5"><a href="s09-Solutions.html#cb136-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n0=</span><span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">5</span>), </span>
<span id="cb136-6"><a href="s09-Solutions.html#cb136-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">prob=</span><span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>)){</span>
<span id="cb136-7"><a href="s09-Solutions.html#cb136-7" aria-hidden="true" tabindex="-1"></a>  frame <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="st">&quot;Time&quot;</span><span class="ot">=</span><span class="dv">0</span><span class="sc">:</span>tmax)</span>
<span id="cb136-8"><a href="s09-Solutions.html#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb136-9"><a href="s09-Solutions.html#cb136-9" aria-hidden="true" tabindex="-1"></a>    AMATS <span class="ot">&lt;-</span> <span class="fu">ArrayFunction</span>(<span class="at">Agood=</span>Agood, </span>
<span id="cb136-10"><a href="s09-Solutions.html#cb136-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Apoor=</span>Apoor,</span>
<span id="cb136-11"><a href="s09-Solutions.html#cb136-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">time=</span>tmax, </span>
<span id="cb136-12"><a href="s09-Solutions.html#cb136-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob=</span>prob)</span>
<span id="cb136-13"><a href="s09-Solutions.html#cb136-13" aria-hidden="true" tabindex="-1"></a>    projectN <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">projection.stochastic</span>(</span>
<span id="cb136-14"><a href="s09-Solutions.html#cb136-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">Amats=</span>AMATS,  <span class="at">n0=</span>n0)[,<span class="sc">-</span><span class="dv">1</span>],<span class="dv">1</span>,sum)</span>
<span id="cb136-15"><a href="s09-Solutions.html#cb136-15" aria-hidden="true" tabindex="-1"></a>    frame <span class="ot">&lt;-</span> <span class="fu">cbind</span>(frame, projectN)</span>
<span id="cb136-16"><a href="s09-Solutions.html#cb136-16" aria-hidden="true" tabindex="-1"></a>     <span class="fu">names</span>(frame)[m<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Rep&quot;</span>,m,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb136-17"><a href="s09-Solutions.html#cb136-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb136-18"><a href="s09-Solutions.html#cb136-18" aria-hidden="true" tabindex="-1"></a>  frame</span>
<span id="cb136-19"><a href="s09-Solutions.html#cb136-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br></p>
<p>Now we can apply the function to compare situations where the probability of drawing a good environment is (e.g.) 0.8, versus 0.2:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="s09-Solutions.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most good environments</span></span>
<span id="cb137-2"><a href="s09-Solutions.html#cb137-2" aria-hidden="true" tabindex="-1"></a>simgullG <span class="ot">&lt;-</span> <span class="fu">nsim.stochastic.gull</span>(<span class="at">nsim=</span><span class="dv">10000</span>, <span class="at">prob=</span><span class="fu">c</span>(.<span class="dv">8</span>,.<span class="dv">2</span>))</span>
<span id="cb137-3"><a href="s09-Solutions.html#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Most poor environments</span></span>
<span id="cb137-4"><a href="s09-Solutions.html#cb137-4" aria-hidden="true" tabindex="-1"></a>simgullP <span class="ot">&lt;-</span> <span class="fu">nsim.stochastic.gull</span>(<span class="at">nsim=</span><span class="dv">10000</span>, <span class="at">prob=</span><span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">8</span>))</span>
<span id="cb137-5"><a href="s09-Solutions.html#cb137-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-6"><a href="s09-Solutions.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the 5, 25, 50, 75, and 95 percentiles:</span></span>
<span id="cb137-7"><a href="s09-Solutions.html#cb137-7" aria-hidden="true" tabindex="-1"></a>PercentilesG  <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(<span class="fu">t</span>(simgullG[,<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb137-8"><a href="s09-Solutions.html#cb137-8" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">2</span>, </span>
<span id="cb137-9"><a href="s09-Solutions.html#cb137-9" aria-hidden="true" tabindex="-1"></a>                         quantile, </span>
<span id="cb137-10"><a href="s09-Solutions.html#cb137-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>,.<span class="dv">95</span>)))</span>
<span id="cb137-11"><a href="s09-Solutions.html#cb137-11" aria-hidden="true" tabindex="-1"></a>PercentilesP  <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(<span class="fu">t</span>(simgullP[,<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb137-12"><a href="s09-Solutions.html#cb137-12" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">2</span>, </span>
<span id="cb137-13"><a href="s09-Solutions.html#cb137-13" aria-hidden="true" tabindex="-1"></a>                         quantile, </span>
<span id="cb137-14"><a href="s09-Solutions.html#cb137-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>,.<span class="dv">95</span>)))</span>
<span id="cb137-15"><a href="s09-Solutions.html#cb137-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-16"><a href="s09-Solutions.html#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Store percentiles in data frame  </span></span>
<span id="cb137-17"><a href="s09-Solutions.html#cb137-17" aria-hidden="true" tabindex="-1"></a>GPercentiles <span class="ot">&lt;-</span> </span>
<span id="cb137-18"><a href="s09-Solutions.html#cb137-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Time&quot;</span><span class="ot">=</span><span class="dv">0</span><span class="sc">:</span>(<span class="fu">dim</span>(PercentilesG)[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>),  </span>
<span id="cb137-19"><a href="s09-Solutions.html#cb137-19" aria-hidden="true" tabindex="-1"></a>                                    PercentilesG))</span>
<span id="cb137-20"><a href="s09-Solutions.html#cb137-20" aria-hidden="true" tabindex="-1"></a>GPercentiles<span class="sc">$</span>Mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">t</span>(PercentilesG[,<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb137-21"><a href="s09-Solutions.html#cb137-21" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">2</span>, </span>
<span id="cb137-22"><a href="s09-Solutions.html#cb137-22" aria-hidden="true" tabindex="-1"></a>                           mean)</span>
<span id="cb137-23"><a href="s09-Solutions.html#cb137-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-24"><a href="s09-Solutions.html#cb137-24" aria-hidden="true" tabindex="-1"></a>PPercentiles <span class="ot">&lt;-</span> </span>
<span id="cb137-25"><a href="s09-Solutions.html#cb137-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Time&quot;</span><span class="ot">=</span><span class="dv">0</span><span class="sc">:</span>(<span class="fu">dim</span>(PercentilesP)[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>),  </span>
<span id="cb137-26"><a href="s09-Solutions.html#cb137-26" aria-hidden="true" tabindex="-1"></a>                                    PercentilesP))</span>
<span id="cb137-27"><a href="s09-Solutions.html#cb137-27" aria-hidden="true" tabindex="-1"></a>PPercentiles<span class="sc">$</span>Mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">t</span>(PercentilesP[,<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb137-28"><a href="s09-Solutions.html#cb137-28" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">2</span>, </span>
<span id="cb137-29"><a href="s09-Solutions.html#cb137-29" aria-hidden="true" tabindex="-1"></a>                           mean)</span>
<span id="cb137-30"><a href="s09-Solutions.html#cb137-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-31"><a href="s09-Solutions.html#cb137-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Add probability value</span></span>
<span id="cb137-32"><a href="s09-Solutions.html#cb137-32" aria-hidden="true" tabindex="-1"></a>GPercentiles<span class="sc">$</span>ProbGood <span class="ot">&lt;-</span> <span class="st">&quot;ProbGood_0.8&quot;</span></span>
<span id="cb137-33"><a href="s09-Solutions.html#cb137-33" aria-hidden="true" tabindex="-1"></a>PPercentiles<span class="sc">$</span>ProbGood <span class="ot">&lt;-</span> <span class="st">&quot;ProbGood_0.2&quot;</span></span>
<span id="cb137-34"><a href="s09-Solutions.html#cb137-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-35"><a href="s09-Solutions.html#cb137-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Join:</span></span>
<span id="cb137-36"><a href="s09-Solutions.html#cb137-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-37"><a href="s09-Solutions.html#cb137-37" aria-hidden="true" tabindex="-1"></a>PercentilesBoth <span class="ot">&lt;-</span> <span class="fu">rbind</span>(GPercentiles, PPercentiles)</span>
<span id="cb137-38"><a href="s09-Solutions.html#cb137-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-39"><a href="s09-Solutions.html#cb137-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Make long format for plotting</span></span>
<span id="cb137-40"><a href="s09-Solutions.html#cb137-40" aria-hidden="true" tabindex="-1"></a>PercentilesBoth.long <span class="ot">&lt;-</span> PercentilesBoth <span class="sc">%&gt;%</span> </span>
<span id="cb137-41"><a href="s09-Solutions.html#cb137-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="sc">-</span>Time,<span class="sc">-</span>ProbGood), </span>
<span id="cb137-42"><a href="s09-Solutions.html#cb137-42" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Percentile&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>)</span>
<span id="cb137-43"><a href="s09-Solutions.html#cb137-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-44"><a href="s09-Solutions.html#cb137-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Make sure the order of the percentiles is correct</span></span>
<span id="cb137-45"><a href="s09-Solutions.html#cb137-45" aria-hidden="true" tabindex="-1"></a>PercentilesBoth.long<span class="sc">$</span>Percentile <span class="ot">&lt;-</span> </span>
<span id="cb137-46"><a href="s09-Solutions.html#cb137-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(PercentilesBoth.long<span class="sc">$</span>Percentile, </span>
<span id="cb137-47"><a href="s09-Solutions.html#cb137-47" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;5%&quot;</span>, <span class="st">&quot;25%&quot;</span>, <span class="st">&quot;50%&quot;</span>, <span class="st">&quot;75%&quot;</span>, <span class="st">&quot;95%&quot;</span>,<span class="st">&quot;Mean&quot;</span>))</span>
<span id="cb137-48"><a href="s09-Solutions.html#cb137-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-49"><a href="s09-Solutions.html#cb137-49" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(PercentilesBoth.long) <span class="sc">+</span> </span>
<span id="cb137-50"><a href="s09-Solutions.html#cb137-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>N, <span class="at">col=</span>Percentile,</span>
<span id="cb137-51"><a href="s09-Solutions.html#cb137-51" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype=</span>Percentile), <span class="at">lwd=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb137-52"><a href="s09-Solutions.html#cb137-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(colors5,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb137-53"><a href="s09-Solutions.html#cb137-53" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb137-54"><a href="s09-Solutions.html#cb137-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb137-55"><a href="s09-Solutions.html#cb137-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">80</span>)<span class="sc">+</span></span>
<span id="cb137-56"><a href="s09-Solutions.html#cb137-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(ProbGood),<span class="at">ncol=</span><span class="dv">2</span>,</span>
<span id="cb137-57"><a href="s09-Solutions.html#cb137-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb137-58"><a href="s09-Solutions.html#cb137-58" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb137-59"><a href="s09-Solutions.html#cb137-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.title =</span> <span class="fu">element_blank</span>() )<span class="sc">+</span></span>
<span id="cb137-60"><a href="s09-Solutions.html#cb137-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x=</span><span class="st">&quot;Time (year)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Population size N&quot;</span>) <span class="sc">+</span></span>
<span id="cb137-61"><a href="s09-Solutions.html#cb137-61" aria-hidden="true" tabindex="-1"></a>   <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-94-1.png" width="576" /></p>
<p><br></p>
<p>In the case where the probability of using the good environment increases (to the right), population growth is higher (perhaps not surprising).</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Caswell1" class="csl-entry">
Caswell, Hal. 2001. <em>Matrix Population Models</em>. 2nd ed. Sunderland, Massachusetts: Sinauer Associates.
</div>
<div id="ref-Kammenga1" class="csl-entry">
Kammenga, J. E., C. A. M. van Gestel, and E. Hornung. 2001. <span>“Switching Life-History Sensitivities to Stress in Soil Invertebrates.”</span> <em>Ecol. Appl.</em> 11: 226–38.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="id_06-references.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="s07-Code-Collection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
